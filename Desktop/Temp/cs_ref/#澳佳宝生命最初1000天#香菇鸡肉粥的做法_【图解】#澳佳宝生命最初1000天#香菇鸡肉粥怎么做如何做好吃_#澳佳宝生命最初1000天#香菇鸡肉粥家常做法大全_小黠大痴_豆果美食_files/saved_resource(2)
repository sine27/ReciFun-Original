$(".like").live("click",function(){if($(this).hasClass("dialike")){return false}if($(this).hasClass("dialike2")){return false}var B=$(this).attr("dietid");var A=$("#comment_container").find(".coimg > a > img").attr("src");var D=$("#comment_container").find(".coimg > a > img").attr("alt");var C=$("#comment_container").find(".coimg > a").attr("href");params="dietid="+B;$.ajax({type:"post",url:"/uajax/addfavNum",data:params,dataType:"json",success:function(F){if(F.data.flag=="NoLogin"){logindialog()}else{if(F.data.flag=="slice"){showerrorinfo("提示",F.data.favs)}else{if(F.data.flag=="OK"){$(".creno").parent().attr("class","xrenzan clearfix");var E="";E=$(".creno").parent().find("h3 a").html();if(E&&$(".creno").parent().attr("class")=="xrenzan clearfix"){newnum=new Number(E.substr(1,E.length-2));$(".creno").parent().find("h3 a").html("("+(++newnum)+")")}if($(".creno > a").html()){$(".creno > a").first().before("<a href='"+C+"' title='"+D+"' target='_blank'><img alt='"+D+"' src='"+A+"' /></a>")}else{$(".creno").append("<a href='"+C+"' title='"+D+"' target='_blank'><img alt='"+D+"' src='"+A+"' /></a>")}if($("#like"+B).hasClass("dilike")){$("#like"+B).removeClass("dilike").addClass("dialike")}$("#like"+B).html('<a href="javascript:void(0);">赞'+F.data.favs+"</a>");$(this).html('<a href="javascript:void(0);">赞'+F.data.favs+"</a>");if(F.data.sharealert=="1"){alertObj.shareAlert("like")}}}}}});$(window).bind("scroll",showMoreDiet)});$(".share").live("mouseover mouseout",function(A){if(A.type=="mouseover"){$("#shareinfo").removeClass("hidden")}else{$("#shareinfo").addClass("hidden")}});$(".difenx").live("mouseover mouseout",function(A){var B=$(this).attr("id");if(A.type=="mouseover"){$("#share"+B).removeClass("hidden")}else{$("#share"+B).addClass("hidden")}});$(".guanzhu").live("click",function(){var A=$(this).attr("userid");var B="add";var C=$(this).hasClass("careadd");if(!C){B="del";C=$(this).hasClass("careyed carehxd")}var D="userid="+A+"&info="+B;$.ajax({type:"post",url:"/uajax/addDelFriend",data:D,dataType:"json",success:function(E){if(E.data.flag=="NoLogin"){logindialog()}else{if(E.data.flag=="slice"){showerrorinfo("提示",E.data.tip)}else{if(E.data.flag=="Success"){if(E.data.status==0||E.data.status==-1){$("#guanzhu"+A).removeClass("carehxd");$("#guanzhu"+A).removeClass("careyed");$("#guanzhu"+A).addClass("careadd");$("#guanzhu"+A).attr("title","+关注")}else{if(E.data.status==1){$("#guanzhu"+A).removeClass("carehxd");$("#guanzhu"+A).removeClass("careadd");$("#guanzhu"+A).addClass("careyed");$("#guanzhu"+A).attr("title","取消关注");if(E.data.sharealert=="1"){alertObj.shareAlert("guanzhu")}}else{$("#guanzhu"+A).removeClass("careyed");$("#guanzhu"+A).removeClass("careadd");$("#guanzhu"+A).addClass("carehxd");$("#guanzhu"+A).attr("title","取消关注")}}}}}}})});$(".uc_guanzhu").live("click",function(){var A=$(this).attr("userid");var B="add";var C=$(this).hasClass("baddf");if(!C){B="del";C=$(this).hasClass("barightf baeachf")}var D="userid="+A+"&info="+B;$.ajax({type:"post",url:"/uajax/addDelFriend",data:D,dataType:"json",success:function(E){if(E.data.flag=="NoLogin"){logindialog()}else{if(E.data.flag=="slice"){showerrorinfo("提示",E.data.tip)}else{if(E.data.flag=="Success"){if(E.data.status==0||E.data.status==-1){$("#guanzhu"+A).removeClass("barightf");$("#guanzhu"+A).removeClass("baeachf");$("#guanzhu"+A).addClass("baddf");$("#guanzhu"+A).attr("title","关注")}else{if(E.data.status==1){$("#guanzhu"+A).removeClass("baeachf");$("#guanzhu"+A).removeClass("baddf");$("#guanzhu"+A).addClass("barightf");$("#guanzhu"+A).attr("title","取消关注");if(E.data.sharealert=="1"){alertObj.shareAlert("guanzhu")}}else{$("#guanzhu"+A).removeClass("barightf");$("#guanzhu"+A).removeClass("baddf");$("#guanzhu"+A).addClass("baeachf");$("#guanzhu"+A).attr("title","取消关注")}}}}}}})});$("#useryaoqinginfo").click(function(){var A=$(this).attr("type");var B="type="+A;$.ajax({type:"post",url:"/uajax/sendyaoqing",data:B,dataType:"json",success:function(C){if(C.data.info=="NOLOGIN"){logindialog()}else{if(C.data.info=="OK"){showerrorinfo("提示信息","邀请成功，微博已发送！")}else{if(C.data.info=="Fail"){showerrorinfo("提示信息","邀请失败，请重新使用微博账号登陆！")}}}}})});$(".newgz").live("click",function(){var A=$(this).attr("userid");var B="add";var C=$(this).hasClass("jiaf");if(!C){B="del";C=$(this).hasClass("quxiaof")}var D="userid="+A+"&info="+B;$.ajax({type:"post",url:"/uajax/addDelFriend",data:D,dataType:"json",success:function(E){if(E.data.flag=="NoLogin"){logindialog()}else{if(E.data.flag=="slice"){showerrorinfo("提示",E.data.tip)}else{if(E.data.flag=="Success"){if(E.data.status==0||E.data.status==-1){$("#guanzhu"+A).removeClass("quxiaof");$("#guanzhu"+A).addClass("jiaf");$("#guanzhu"+A).attr("title","+关注")}else{if(E.data.status==1){$("#guanzhu"+A).removeClass("jiaf");$("#guanzhu"+A).addClass("quxiaof");$("#guanzhu"+A).attr("title","取消关注")}else{$("#guanzhu"+A).removeClass("jiaf");$("#guanzhu"+A).addClass("quxiaof");$("#guanzhu"+A).attr("title","取消关注")}}}}}}})});$(".newgzz").live("click",function(){var A=$(this).attr("userid");var B="add";var C=$(this).hasClass("careadd2");if(!C){B="del";C=$(this).hasClass("quxiaof")}var D="userid="+A+"&info="+B;$.ajax({type:"post",url:"/uajax/addDelFriend",data:D,dataType:"json",success:function(E){if(E.data.flag=="NoLogin"){logindialog()}else{if(E.data.flag=="slice"){showerrorinfo("提示",E.data.tip)}else{if(E.data.flag=="Success"){if(E.data.status==0||E.data.status==-1){$("#guanzhu"+A).removeClass("careyed2");$("#guanzhu"+A).removeClass("carehxd");$("#guanzhu"+A).addClass("careadd2").html("+关注");$("#guanzhu"+A).attr("title","+关注");$("#guanzhu"+A).attr("onmouseout",'$(this).removeClass("carehqxd").html("+关注")');$("#guanzhu"+A).removeAttr("onmouseover")}else{if(E.data.status==1){$("#guanzhu"+A).removeClass("careadd2");$("#guanzhu"+A).removeClass("carehxd");$("#guanzhu"+A).addClass("careyed2").html("已关注");$("#guanzhu"+A).attr("title","取消关注");$("#guanzhu"+A).attr("onmouseover",'$(this).addClass("carehqxd").html("取消关注")');$("#guanzhu"+A).attr("onmouseout",'$(this).removeClass("carehqxd").html("已关注")');$("#guanzhu"+A).attr("onclick",'$(this).removeClass("carehqxd").html("")');if(E.data.sharealert=="1"){alertObj.shareAlert("guanzhu")}}else{$("#guanzhu"+A).removeClass("careadd2");$("#guanzhu"+A).removeClass("careyed2");$("#guanzhu"+A).addClass("careyed2").html("互相关注");$("#guanzhu"+A).attr("title","取消关注");$("#guanzhu"+A).attr("onmouseover",'$(this).addClass("carehqxd").html("取消关注")');$("#guanzhu"+A).attr("onmouseout",'$(this).html("互相关注")');$("#guanzhu"+A).attr("onclick",'$(this).removeClass("carehqxd").html("")')}}}}}}})});$(window).ready(function(){
	$(".opusic").live({
		mouseover:function(){
			var dishid = $(this).attr("dishid");
			$('.opusic[dishid='+dishid+']').children(".w18h14").addClass('opalpha9');
			$('.opusic .imglikebtn[dishid='+dishid+']').show();
		},
		mouseout:function(){
			var dishid = $(this).attr("dishid");
			$('.opusic[dishid='+dishid+']').children(".w18h14").removeClass('opalpha9');
			$('.opusic .imglikebtn[dishid='+dishid+']').hide();
		}
	});
	$('.mscolse').click(function(){
		$('.mserma').hide()
	});
	//作品汇集列表页面
	$('.imglikebtn').click(function(){
		var obj	= $(this);
		if(parseInt(obj.attr('dishid')) && obj.attr('class').indexOf('btnysc') < 0)
		{
			var id		= obj.attr('dishid');
			var params	= "&d_id="+id;
			$.ajax({
				type : 'post',
				url	 : '/uajax/addDishFav',
				data : params,
				dataType : 'json',
				success : function(msg){
					if(msg.data.flag == 'NoLogin')
					{
						logindialog();
					}
					else if(msg.data.flag == 'slice')
					{
						showerrorinfo('提示', msg.data.favs);
					}
					else
					{
						if(msg.status == 'OK')
						{
							obj.html('已喜欢');
							obj.removeClass('btnsc').addClass('btnysc');
							$('.likeId a[dishid='+id+']').html(parseInt(msg.data.favs)+' 已喜欢');
							$('.likeId a[dishid='+id+']').removeClass('reczulikeed').addClass('reczulike');
						}
					}
				}
			});
		}
	});
	//list页面赞
	$('.likeId a').click(function(){
		var obj	= $(this);
		if(parseInt(obj.attr('dishid')))
		{
			var id		= obj.attr('dishid');
			var params	= "&d_id="+id;
			$.ajax({
				type : 'post',
				url	 : '/uajax/addDishFav',
				data : params,
				dataType : 'json',
				success : function(msg){
					if(msg.data.flag == 'NoLogin')
					{
						logindialog();
					}
					else if(msg.data.flag == 'slice')
					{
						showerrorinfo('提示', msg.data.favs);
					}
					else
					{
						if(msg.status == 'OK')
						{
							obj.html(parseInt(msg.data.favs)+' 已喜欢');
							obj.removeClass('reczulikeed').addClass('reczulike');
							$('.opusic .imglikebtn[dishid='+id+']').html('已喜欢');
							$('.opusic .imglikebtn[dishid='+id+']').removeClass('btnsc').addClass('btnysc');
						}
					}
				}
			});
		}
	});

	//收藏
	$("#shoucangInfo").click(function(){
		var scValue = $("#shoucangValue").val(); //scValue的值：0：未登陆，1：未收藏，2：收藏
		$("#caidan").addClass("hidden");
		$("#newcaidan").addClass("hidden");
		if(scValue == 0)
		{
            logindialog();
		}else if(scValue == 1)
		{
		    var id = 'favoritdl'
		    var h = $(window).height() / 2 - 150;
		    var w = $(window).width() / 2 - 300;
		    $("#favoritdl").css('top',h);
		    $("#favoritdl").css('left',w);
		    var he = $(document).height();
			var html= '<div class="blobg"></div>'
			$('body').append(html);
			$(".blobg").css({height:he});
			/*$("#favoritdl").dialog({
			    resizable:false,
			    draggable:false,
				width: 600,
				position: [w, h],
			    modal:true
			});*/
			$(".ui-icon-closethick").hide();
			$(".otpitm").show();
			$("#favoritdl").show();
			 $(".dlclose").live("click",function(){
			  //  $("#"+id).remove();
			    /*$("#"+id).dialog("close");*/
			    $("#favoritdl").hide();
			    $(".blobg").remove();
			});

			 $("#favoritdl_close").live("click",function(){
			   // $("#"+id).remove();
			   /* $("#"+id).dialog("close");*/
			    $("#favoritdl").hide();
			    $(".blobg").remove();
			});
			var cookid = $("#shoucangInfo").attr("data-id");
			$.ajax({
				type:'post',
				url:'/uajax/addDelCollectInfo?'+Math.random(),
				data:'&cookid='+cookid+"&status=0",
				dataType:'json',
				success:function(msg)
				{
					if(msg.data == 'NoLogin')
					{
						logindialog();
					}else if(msg.data == 'slice')
					{
						$("#favoritdl").hide();
						$(".blobg").remove();
						showerrorinfo('提示', '您仍处在禁言期内，不能发表内容。');
					}else if(msg.data == 'HAS')
					{
						alert('此菜谱已收藏！');
					}else if(msg.data == 'EMPTYINFO')
					{
						alert('菜谱不存在！');
					}else if(msg.data == 'ERROR')
					{
						alert('收藏失败！');
					}else
					{
						$("#shoucangValue").val('2');
						$("#shoucangInfo").removeClass("cpscsc");
						$("#shoucangInfo").addClass("cpysc");
						$("#shoucangInfo").html("已收藏");
						$("#collectsnum").html(parseInt($("#collectsnum").html()) + 1);
						$("#shoucangTag").removeClass("hidden");

						var userimage = $("#comment_container").find('.coimg > a > img').attr('src');
						var username = $("#comment_container").find('.coimg > a > img').attr('alt');
    					var userurl = $("#comment_container").find('.coimg > a').attr('href');
						html	= '<a href="'+userurl+'" rel="nofollow" target="_blank" title="'+username+'"><img alt="'+username+'" src="'+userimage+'"></a>';
						$("#collectUser").prepend(html);
						if($("#collectUser a").size() > 16)
						{
							$("#collectUser a:last").remove();
						}
					}
				}
			})
		}
	})	
	//已收藏鼠标移动上面显示，隐藏	end
	$(".shoucanginfoaction").live("mouseover mouseout",function(event){
		var scValue = $("#shoucangValue").val();
		var cookid = $(this).attr("data-id");
		if(scValue == 2)
		{
			if(event.type == 'mouseover')
			{
				$("#shoucangbiaoqian").removeClass("hidden");
			}else
			{
				$("#shoucangbiaoqian").addClass("hidden");
			}
		}
	});
	//微信展示二维码模块
	$('.newfx_wx').click(function(){
		$(".wxfen").show();
	});
	$('.wclos').click(function(){
		$(this).parent().hide();
	});
	//登陆__隐藏
	$(".scengx").click(function(){
		$(this).parent().addClass("hidden");
	})
	//菜单的关闭
	$("#caidan").find(".dlclose").click(function(){
		$("#caidan").hide();
		$(".blobg").remove();
	})
	$("#newcaidan").find(".dlclose").click(function(){
		$("#newcaidan").hide();
		$(".blobg").remove();
	})
	//点击加入菜单__弹出显示
	$(".btnjdb").click(function(){
		var he = $(document).height();
		var html= '<div class="blobg"></div>'
		$('body').append(html);
		$(".blobg").css({height:he});
		$("#shoucangTag").addClass("hidden");
		/*$("#newcaidan").dialog("close");
		$("#newcaidan").addClass("hidden");*/
		var cook_id = $("#shoucangInfo").attr("data-id");
		$("#error_area").html("");
		$("#caidanTitleError").html("");
		$.ajax({
			type: 'post',
			url: '/uajax/getcaidan',
			data: 'cookid='+cook_id,
			dataType: 'json',
			success: function(msg)
			{
				if(msg.data == "nologin")
				{
                    logindialog();
				}
				else if(msg.data == "nocook")
				{
					showerrorinfo('提示', '此菜谱信息不存在！');
				}
				else if(msg.status == 'ERR' && msg.data == 'slice')
				{
					showerrorinfo('提示', '您仍处在禁言期内，不能发表或编辑内容。');
				}
				else if(msg.status == 'OK')
				{
					var h = $(window).height() / 2 - 150;
			    	var w = $(window).width() / 2 - 300;
					if(msg.data == '')
					{
						$("#newcaidan").css('top',h);
			    		$("#newcaidan").css('left',w);
						/*$("#newcaidan").dialog({
					        resizable:false,
					        draggable:false,
					        modal:true
				    	});
						$("#newcaidan").removeClass("hidden");
						$("#caidan").addClass("hidden");*/
						$("#newcaidan").show();
						$("#caidan").hide();
					}else
					{
						$("#caidan").css('top',h);
			    		$("#caidan").css('left',w);
						/*$("#caidan").dialog({
					        resizable:false,
					        draggable:false,
					        modal:true
				    	});*/
						$(".menuzi").html(msg.data);
						/*$("#caidan").removeClass("hidden");*/
						$("#newcaidan").hide();
						$("#caidan").show();
					}
				}
			}
		})
	})

	//添加菜单分组信息
	$("#doLogin").live('click',function(){
		var caidangroupid = $("input[name=caidangroup]:checked").val();
		var cook_id = $("#shoucangInfo").attr("data-id");
		var caipuid = $("#caidanid").val();
		if(caidangroupid)
		{
			$.ajax({
				type: 'post',
				url: '/uajax/addCaidanGroup',
				data: 'cdgroupid='+caidangroupid+'&cookid='+cook_id+"&caipuid="+caipuid,
				dataType: 'json',
				success: function(msg)
				{
					if(msg.data == 'OK')
					{
						$("#caidanGroupDialogIndex").dialog('close');
					}else if(msg.data == 'Fail')
					{
						showerrorinfo('提示', '菜单分组添加失败！');
						$("#caidanGroupDialogIndex").dialog('close');
					}else
					{
						logindialog();
					}
				}
			})
		}else
		{
			$("#caidanGroupDialogIndex").dialog('close');
		}
	})
	//创建一个新的菜单
	$(".createCaiDan").click(function(){
		var h = $(window).height() / 2 - 150;
    	var w = $(window).width() / 2 - 300;
    	$("#newcaidan").css('top',h);
    	$("#newcaidan").css('left',w);
		 /*$("#newcaidan").dialog({
	        resizable:false,
	        draggable:false,
	        modal:true
	    });*/
	    $("#caidanTitle").val('菜单标题(必填)');
	    $("#caidanjieshao").val('菜单介绍');
		/*$("#caidan").dialog("close");*/
		$("#caidan").hide();
		/*$("#newcaidan").removeClass("hidden");*/
		$("#newcaidan").show();

		$("#caidanGroupDialogIndex").remove();
	})
	//点击收藏_隐藏标签的弹出框
	$("#quxiao").click(function(){
		$(this).parent().parent().addClass("hidden");
	})
	//显示的菜单__隐藏
	$(".scengx").click(function(){
		$(this).parent().addClass("hidden");
	})
	//隐藏菜单分组信息
	$(".caidangroup").live('click', function(){
		$("#caidanGroupDialogIndex").remove();
	});
	//其他N道菜谱信息
	$(".otoxer2").click(function(){
		if($(".othereci").hasClass("hidden"))
		{
			$(this).removeClass('otoxer2').addClass('otoxer');
			$(".othereci").removeClass("hidden");
		}else
		{
			$(this).removeClass('otoxer').addClass('otoxer2');
			$(".othereci").addClass("hidden");
		}
	})
	$("#cooktagInput").click(function(){
		$(this).find('input').focus();
	})

})
//取消收藏
$("#exitshoucang").click(function(){
	var cookid = $("#shoucangInfo").attr("data-id");
	$.ajax({
		type: 'post',
		url: '/uajax/addDelCollectInfo?'+Math.random(),
		data: 'cookid='+cookid+'&&status=1',
		dataType: 'json',
		success: function(msg)
		{
			if(msg.data == 'NoLogin')
			{
				logindialog();
			}else if(msg.data == 'slice')
			{
				showerrorinfo('提示', '您仍处在禁言期内，不能发表内容。');
			}else if(msg.data == 'OK')
			{
			        //$("#favoritdl").remove();				
				$("#shoucangValue").val('1');
				$(".bime").remove();				
				$("#shoucangInfo").removeClass("cpysc");
				$("#shoucangInfo").addClass("cpscsc");
				$("#shoucangbiaoqian").addClass("hidden");
				$("#shoucangInfo").html("收藏");
				$("#collectsnum").html(parseInt($("#collectsnum").html()) - 1);
				var username = $("#comment_container").find('.coimg > a > img').attr('alt');
    			$("#collectUser a[title="+username+"]").remove();
			}else
			{
				showerrorinfo('提示', '取消收藏失败！');
			}
		}
	})
})

$("#updatetaginfo").click(function(){
			var he = $(document).height();
			var html= '<div class="blobg"></div>'
			$('body').append(html);
			$(".blobg").css({height:he});
		    var id = 'favoritdl'
		    var h = $(window).height() / 2 - 150;
		    var w = $(window).width() / 2 - 300;
		    $("#favoritdl").css('top',h);
		    $("#favoritdl").css('left',w);
			/*$("#favoritdl").dialog({
			    resizable:false,
			    draggable:false,
			    modal:true
			});*/
			$("#favoritdl").show();
			 $(".dlclose").live("click",function(){
			  //  $("#"+id).remove();
			    /*$("#"+id).dialog("close");*/
			    $("#favoritdl").hide();
			    $(".blobg").remove();
			});

			 $("#favoritdl_close").live("click",function(){
			   // $("#"+id).remove();
			   /* $("#"+id).dialog("close");*/
			    $("#favoritdl").hide();
			    $(".blobg").remove();
			});
			var cookid = $("#shoucangInfo").attr("data-id");
			$(".otpitm").hide();
})
function showNextCaipu(obj)
{
	var cook_id	= $("#page_cm_id").attr('val');
	var user_id	= $("#page_cm_id").attr('uid');
	var offset	= parseInt($("#otherCaipusList").attr('val'));
	var max		= parseInt($("#otherCaipusList").attr('max'));
    if (offset == 1)
    {
        $("#left_btn").attr('class','btn_next obtn blef');
    }
	if (offset <= 0) return false;
    if ((offset + 1)* 4 >= max)
    {
        $("#right_btn").attr('class','btn_pre2 obtn brigh');
    }
    if((offset)* 4 >= max)
    {
		return false;
    }
    $(".othloading").show();
	$.ajax({
		type: 'post',
		url: '/ajax/getOtherCaipus/' + user_id + '/' + cook_id + '/' + offset,
		dataType: 'json',
		success: function(msg)
		{
			if (msg.data != '')
			{
				offset	= offset + 1;
				$("#otherCaipusList").attr('val', offset);
				$("#otherCaipusList").html(msg.data);
			}

		}
	})
	$(".othloading").fadeOut();
}
function showPrevCaipu(obj)
{
	var cook_id	= $("#page_cm_id").attr('val');
	var user_id	= $("#page_cm_id").attr('uid');
	var offset	= parseInt($("#otherCaipusList").attr('val'));
	var max		= parseInt($("#otherCaipusList").attr('max'));
	if (offset > 1)
    {
        $("#right_btn").attr('class','btn_pre obtn brigh');
    }
	if ((offset - 2) <= 0)
	{
		offset = 0;
	}
	else
	{
		offset = offset - 2;
	}
	if (offset < 0)
    {
        return false;
    }
    if (offset < 2)
    {
        $("#left_btn").attr('class','btn_next2 obtn blef');
    }
    $(".othloading").show();
	$.ajax({
		type: 'post',
		url: '/ajax/getOtherCaipus/' + user_id + '/' + cook_id + '/' + offset,
		dataType: 'json',
		success: function(msg)
		{
			if (msg.data != '')
			{
				offset	= offset == 0 ? 1 : offset;
				$("#otherCaipusList").attr('val', offset);
				$("#otherCaipusList").html(msg.data);
			}

		}
	})
    $(".othloading").fadeOut();
}
function showOtherCaipu()
{
	var cookid = $("#shoucangInfo").attr("data-id");
	$("#othercaipusdiv").toggle();
}

/**
 * @desc:添加收藏数
 * @return:{json}
**/
function addShouCangInfo()
{
	var cook_id = $("#shoucangInfo").attr("data-id");
	var mpadstr = $(".bime").length;
	var tagname = '';
	if(mpadstr > 0)
	{
		for(var i = 0; i < mpadstr; i++)
        {
			var char = ((mpadstr-1) == i) ? ' ' : ',';
			tagname += $(".bime").find("input").eq(i).val() + char;
        }
	}
	$.ajax({
		type: 'post',
		url: '/uajax/addTagInfo',
		data: 'cookid='+cook_id+"&tags="+tagname,
		dataType: 'json',
		success: function(msg)
		{
			if(msg.data.info == "NoLogin")
			{
				logindialog();
			}else if(msg.data.info == "NoCookinfo")
			{
				showerrorinfo('菜谱信息', '没有本菜谱信息！');
			}else if(msg.data.info == 'OK')
			{
				$(".scengx").parent().addClass("hidden");
				//$("#displaytag").html(msg.data.tag);
				$("#shoucangInfo").removeClass("cpscsc");
				$("#shoucangInfo").addClass("cpysc");
				$("#shoucangInfo").html("已收藏");
			}else if(msg.data.info == 'slice')
			{
				showerrorinfo('提示', msg.data.tip);
			}else
			{
				showerrorinfo('操作错误', '添加标签操作失败！');
			}
		}
	})
}


/**
 * @desc: 添加菜谱组信息
 * @param int $cid
**/
function caidanInfo(cid)
{
	var checkboxValue = $("#caidaninfo"+cid).hasClass("checkeding");
	if(checkboxValue)
	{
		$("#caidaninfo"+cid).removeClass("checkeding");
		$.ajax({
			type: 'post',
			url: '/uajax/getcaidanGroup',
			data: 'caipuid='+cid,
			dataType: 'json',
			success: function(msg)
			{
				if(msg.data != 'nodata')
				{
					var str = '<input type="hidden" name="caidanid" id="caidanid" value="'+cid+'"/>';
					tipCaidanGroup(str + msg.data);
					$("#caidanGroupDialogIndex").dialog();
				}
			}
		})
	}else
	{
		$("#caidaninfo"+cid).addClass("checkeding");
	}
}

/**
 * @desc: 添加新的菜单
 * @time: 2012-07-10
**/
function addSaveCaidan()
{
	var caidantitle = $("#caidanTitle").val();
	$("#caidanTitleError").html('');
	if(caidantitle == '' || caidantitle == '菜单标题(必填)')
	{
		$("#caidanTitleError").html('请填写菜单标题');
		return false;
	}
	var caidanjieshao = $("#caidanjieshao").val();
	var cook_id = $("#shoucangInfo").attr("data-id");
	$.ajax({
		type: 'post',
		url: '/uajax/addCaidanInfo',
		data: 'cookid='+cook_id+"&caidantitle="+caidantitle+"&caidanjieshao="+caidanjieshao,
		dataType: 'json',
		success: function(msg)
		{
			if(msg.data == "nologin")
			{
				logindialog();
			}
			else if(msg.data == "nocook")
			{
				showerrorinfo('温馨提示', '此菜谱信息不存在哦！');
			}
			else if(msg.data == 'OK')
			{
				showerrorinfo('温馨提示', '此菜单信息添加成功！');
				$('#newcaidan').hide();
				$(".blobg").remove();
			}
			else if(msg.data == 'slice')
			{
				showerrorinfo('提示', '您仍处在禁言期内，不能发表或编辑内容。');
			}
			else
			{
				showerrorinfo('操作错误', '此菜单信息添加失败！');
			}
		}
	})
}


/**
 * @desc:添加已经有的菜单信息
 * @return: json $json
**/
function addHasCaidan()
{
	var arrnochecked =[];
	var arrchecked = [];
	var arrcheckednum = [];
	$("input[name='caidan_id[]']").each(function(){
		if($(this).attr('oldchecked') == 'checked' && $(this).is(':checked') == false)
		{
			arrnochecked.push($(this).val());
		}
		if($(this).attr('oldchecked') == '' && $(this).is(':checked') == true)
		{
			arrchecked.push($(this).val());
		}
		if($(this).is(':checked') == true)
		{
			arrcheckednum.push($(this).val());
		}
	});
	var cook_id = $("#shoucangInfo").attr("data-id");
	if(arrcheckednum == '')
	{
		 $("#error_area").html('提示: 亲，你没有选择菜单哦！');
		return false;
	}
	$.ajax({
		type: 'post',
		url: '/uajax/addCaidanTitleInfo',
		data: 'cookId='+cook_id+"&arrnochecked="+arrnochecked+"&arrchecked="+arrchecked,
		dataType: 'json',
		success: function(msg)
		{
			if(msg.data == "nologin")
			{
				logindialog();
				$("#nologinshoucang").removeClass("hidden");
			}
			else if(msg.data == 'slice')
			{
				showerrorinfo('提示', '您仍处在禁言期内，不能发表或编辑内容。');
			}
			else if(msg.data == "Fail")
			{
				showerrorinfo('提示', '此菜单信息添加失败！');
			}else if(msg.data == 'OK')
			{
				showerrorinfo('提示', '此菜单信息添加成功！');
				/*$('#caidan').dialog('close');*/
				$('#caidan').hide();
				$(".blobg").remove();
			}else
			{
				showerrorinfo('提示', '此菜单信息添加失败！');
			}
		}
	})
}

$(".deleteCook").click(function(){
	var cook_id = $(this).attr("data-id");
	var user_id	= $("#page_cm_id").attr('uid');
	$.fn.confirm({
		msg:'确定删除这个菜谱？',
		callback:function(){
			$.ajax({
				type:"post",
				url:"/uajax/actionDelCaipu",
				data:"cookid="+cook_id+"&uid="+user_id,
				dataType:"json",
				async: false,
				success: function(msg)
				{
					if(msg.data.flag == "Success")
					{
						window.location.reload();
					}
					else if(msg.data.flag == 'slice')
					{
						showerrorinfo('提示', msg.data.tip);
					}
					else if(msg.data.flag == 'NoLogin')
					{
						logindialog();
					}
					else
					{
						showerrorinfo('提示',"删除失败！");
					}
				}
			})
		}
	})
})

/**
 *@desc:点击取消，取消不同的弹出框
**/
function disHidden(id)
{
	if(id == 1)
	{
		$("#caidan").addClass("hidden");
	}else
	{
		$("#newcaidan").addClass("hidden");
	}
}
function isBaiduLogin(cid)
{
	var h  = $(window).height() / 2 - 200;
    var w  = $(window).width() / 2 - 250;
    var he = $(document).height();
    var id = 'bdyunceng';
    var html='<div id="' + id + '" randnum="'+ parseInt(1000*Math.random()) +'" class="bdyunceng r5" style="z-index: 9999; top: '+ h +'px; left: '+ w +'px; position: fixed; width:500px;height:380px;">';
            html += '<div class="bdyuncontent clearfix" style="width:500px;height:380px;">';
                html += '<a href="javascript:void(0);" class="scengb dlclose"></a>';
                     html += '<div class="tith">';
				 	 html += '<h3>保存到百度云盘</h3>';
					 html += '</div>';
					 html += '<iframe id="bdyun_frame" src="/api/baidu_pcs/'+cid+'" height="400" width="500"></iframe>'
            html += '</div>';
        html += '</div>'
        html += '<div class="blobg"></div>';
	$('body').append(html);
	$(".blobg").css({height:he});
    /*$("#"+id).dialog({
        resizable:false,
        draggable:false,
        modal:true
    });*/
    $(".dlclose").live("click",function(){
        $("#"+id).remove();
        /*$("#"+id).dialog("close");*/
        $(".blobg").remove();
    });
}
function closeBaiduCeng()
{
	$("#bdyunceng").remove();
    $("#bdyunceng").dialog("close");
}
function showTBK(content)
{
	var h  = $(window).height() / 2 - 230;
    var w  = $(window).width() / 2 - 300;
    var id = 'buyceng';
    var html='<div id="' + id + '" randnum="'+ parseInt(1000*Math.random()) +'" class="buyceng r5" style="z-index: 9999; top: '+ h +'px; left: '+ w +'px; position: fixed; width:500px;">';
            html += content;
        html += '</div>';
    $('body').append(html);
    $("#"+id).dialog({
        resizable:false,
        draggable:false,
        modal:true
    });
    $(".dlclose").live("click",function(){
        $("#"+id).remove();
        $("#"+id).dialog("close");
    });
}
function addPoint(cook_id)
{
	var h	= $(window).height()/2 - 165;
	var w	= $(window).width()/2 - 265;
	var he = $(document).height();
	var id	= 'addpoint';
	var html	= '<div id="'+id+'" class="yingyceng r5" randnum="'+parseInt(1000*Math.random())+'" style="z-index: 9999; top:'+h+'px; left:'+w+'px;position: fixed;">';
			html += '<div class="xbcontent clearfix">'
				html += '<a href="#" class="scengb dlclose"></a>'
					html += '<div class="tith">'
						html += '<h3>添加营养点评</h3>'
					html += '</div>'
					html += '<div class="iyping">'
						html += '<h2>点评内容</h2>'
						html += '<textarea id="point_content" placeholder="不超过300字" maxlength="300" class="ypingext r5"></textarea>';
						html += '<div class="buttjqx">'
							html += '<input type="button" class="btncengdl" id="addpoinbtn" value="提交">';
							html += '<input type="button" class="btncengdl ml80" id="closebtn" value="取消">';
						html += '</div>'
					html += '</div>'
			html += '</div>'
		html += '</div>';
		html += '<div class="blobg"></div>';
	$('body').append(html);
	$(".blobg").css({height:he});
	/*$('#'+id).dialog({
		resizable: false,
		draggable: false,
		modal: true
	});*/
	$('.dlclose').live('click', function(){
		$('#'+id).remove();
		/*$("#"+id).dialog("close");*/
		$(".blobg").remove();
	});
	$('#closebtn').live('click', function(){
		$('#'+id).remove();
		/*$("#"+id).dialog("close");*/
		$(".blobg").remove();
	});
	$('#addpoinbtn').live('click', function(){
		var content	= $('#point_content').val();
		if(!content)
		{
			alert('请输入点评内容');
			return false;
		}
		if(content.length>300)
		{
			alert('字数超出限制，只能300');
			return false;
		}
		var params	= '&cook_id='+cook_id+'&content='+encodeURIComponent(content);
		$(this).attr('disabled');
		$.ajax({
			type: 'post',
			url: '/uajax/ajaxAddPoint',
			data: params,
			dataType: 'json',
			async: false,
			success: function(msg){
				$('#'+id).remove();
				/*$("#"+id).dialog("close");*/
				$(".blobg").remove();
				if(msg.status == 'OK')
				{
					showerrorinfo('提示', '点评成功！请等待审核通过');
					window.location.href=window.location.href;
				}
				else if(msg.status == 'ERR' && msg.data == 'Have')
				{
					showerrorinfo('提示', '这道菜已经有营养师点评，请换一道菜进行点评吧！');
					window.location.href=window.location.href;
				}
				else if(msg.status == 'ERR' && msg.data == 'fail')
				{
					$(this).removeAttr('disabled');
					showerrorinfo('提示', '点评失败了，再试一次吧！');
				}
				else if(msg.status == 'ERR' && msg.data == 'slice')
				{
					showerrorinfo('提示', '您仍处在禁言期内，不能发表或编辑内容。');
				}
				else if(msg.status == 'ERR' && msg.data == 'noLogin')
				{
					logindialog();
				}
			}
		});
	})
}
/*
 *	@DESC 展开全部特效
 *	@author cntnn11
*/
$('.zkbtn').click(function(){
	var id	= $(this).attr('pid');
	$(this).hide();
	$('.zk'+id).removeClass('hidden');
	$('.zk'+id).show();
});
$('.sqbtn').click(function(){
	var id	= $(this).attr('pid');
	$('.zkbtn').each(function(){
		if($(this).attr('pid') == id)
		{
			$('.zk'+id).hide();
			$(this).show();
		}
	});
});
/*用手机看效果*/
$('.btnsee').click(function(){
	$(this).parent().find(".byseei").show();
});
$('.mclos').click(function(){
	$(this).parent().hide();
});

/*活动滚动*/
(function($){
    $.fn.slidehd=function(options){
        $.fn.slidehd.deflunt={
        effect : "fade",
        autoPlay:false,
        delayTime : 1000,
        interTime : 5000,
        defaultIndex : 0,
        titCell:".hd li",
        mainCell:".bd",
        trigger: "click",
        scroll:1,
        vis:1,
        titOnClassName:"on",
        autoPage:false,
        prevCell:".prev",
        nextCell:".next"
        };

        return this.each(function() {
            var opts = $.extend({},$.fn.slidehd.deflunt,options);
            var index=opts.defaultIndex;
            var prevBtn = $(opts.prevCell, $(this));
            var nextBtn = $(opts.nextCell, $(this));
            var navObj = $(opts.titCell, $(this));
            var navObjSize = navObj.size();
            var conBox = $(opts.mainCell , $(this));
            var conBoxSize=conBox.children().size();
            var slideH=0;
            var slideW=0;
            var selfW=0;
            var selfH=0;
            var autoPlay = opts.autoPlay;
            var inter=null;
            var oldIndex = index;

            if(conBoxSize<opts.vis) return;


            if( navObjSize==0 )navObjSize=conBoxSize;
            if( opts.autoPage ){
                var tempS = conBoxSize-opts.vis;
                navObjSize=1+parseInt(tempS%opts.scroll!=0?(tempS/opts.scroll+1):(tempS/opts.scroll));
                navObj.html("");
                for( var i=0; i<navObjSize; i++ ){ navObj.append("<li>"+(i+1)+"</li>") }
                var navObj = $("li", navObj);
            }

            conBox.children().each(function(){
                if( $(this).width()>selfW ){ selfW=$(this).width(); slideW=$(this).outerWidth(true);  }
                if( $(this).height()>selfH ){ selfH=$(this).height(); slideH=$(this).outerHeight(true);  }
            });

            switch(opts.effect)
            {
                case "top": conBox.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; height:'+opts.vis*slideH+'px"></div>').css( { "position":"relative","padding":"0","margin":"0"}).children().css( {"height":selfH} ); break;
                case "left": conBox.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; width:300px"></div>').css( { "width":conBoxSize*slideW,"position":"relative","overflow":"hidden","padding":"0","margin":"0"}).children().css( {"float":"left","width":selfW} ); break;
                case "leftLoop":
                case "leftMarquee":
                    conBox.children().clone().appendTo(conBox).clone().prependTo(conBox);
                    conBox.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; width:300px"></div>').css( { "width":conBoxSize*slideW*3,"position":"relative","overflow":"hidden","padding":"0","margin-left":"0px","left":-conBoxSize*slideW}).children().css( {"float":"left","width":selfW}  ); break;
                case "topLoop":
                case "topMarquee":
                    conBox.children().clone().appendTo(conBox).clone().prependTo(conBox);
                    conBox.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; height:'+opts.vis*slideH+'px"></div>').css( { "height":conBoxSize*slideH*3,"position":"relative","padding":"0","margin":"0","top":-conBoxSize*slideH}).children().css( {"height":selfH} ); break;
            }

            //效果函数
            var doPlay=function(){
                switch(opts.effect)
                {
                    case "fade": case "top": case "left": if ( index >= navObjSize) { index = 0; } else if( index < 0) { index = navObjSize-1; } break;
                    case "leftMarquee":case "topMarquee": if ( index>= 2) { index=1; } else if( index<0) { index = 0; } break;
                    case "leftLoop": case "topLoop":
                        var tempNum = index - oldIndex;
                        if( navObjSize>2 && tempNum==-(navObjSize-1) ) tempNum=1;
                        if( navObjSize>2 && tempNum==(navObjSize-1) ) tempNum=-1;
                        var scrollNum = Math.abs( tempNum*opts.scroll );
                        if ( index >= navObjSize) { index = 0; } else if( index < 0) { index = navObjSize-1; }
                    break;
                }
                switch (opts.effect)
                {
                    case "fade":conBox.children().stop(true,true).eq(index).fadeIn(opts.delayTime).siblings().hide();break;
                    case "top":conBox.stop(true,true).animate({"top":-index*opts.scroll*slideH},opts.delayTime);break;
                    case "left":conBox.stop(true,true).animate({"left":-index*opts.scroll*slideW},opts.delayTime);break;
                    case "leftLoop":
                        if(tempNum<0 ){
                                conBox.stop(true,true).animate({"left":-(conBoxSize-scrollNum )*slideW},opts.delayTime,function(){
                                for(var i=0;i<scrollNum;i++){ conBox.children().last().prependTo(conBox); }
                                conBox.css("left",-conBoxSize*slideW);
                            });
                        }
                        else{
                            conBox.stop(true,true).animate({"left":-( conBoxSize + scrollNum)*slideW},opts.delayTime,function(){
                                for(var i=0;i<scrollNum;i++){ conBox.children().first().appendTo(conBox); }
                                conBox.css("left",-conBoxSize*slideW);
                            });
                        }break;// leftLoop end

                    case "topLoop":
                        if(tempNum<0 ){
                                conBox.stop(true,true).animate({"top":-(conBoxSize-scrollNum )*slideH},opts.delayTime,function(){
                                for(var i=0;i<scrollNum;i++){ conBox.children().last().prependTo(conBox); }
                                conBox.css("top",-conBoxSize*slideH);
                            });
                        }
                        else{
                            conBox.stop(true,true).animate({"top":-( conBoxSize + scrollNum)*slideH},opts.delayTime,function(){
                                for(var i=0;i<scrollNum;i++){ conBox.children().first().appendTo(conBox); }
                                conBox.css("top",-conBoxSize*slideH);
                            });
                        }break;//topLoop end

                    case "leftMarquee":
                        var tempLeft = conBox.css("left").replace("px","");

                        if(index==0 ){
                                conBox.animate({"left":++tempLeft},0,function(){
                                    if( conBox.css("left").replace("px","")>= 0){ for(var i=0;i<conBoxSize;i++){ conBox.children().last().prependTo(conBox); }conBox.css("left",-conBoxSize*slideW);}
                                });
                        }
                        else{
                                conBox.animate({"left":--tempLeft},0,function(){
                                    if(  conBox.css("left").replace("px","")<= -conBoxSize*slideW*2){ for(var i=0;i<conBoxSize;i++){ conBox.children().first().appendTo(conBox); }conBox.css("left",-conBoxSize*slideW);}
                                });
                        }break;// leftMarquee end

                        case "topMarquee":
                        var tempTop = conBox.css("top").replace("px","");
                            if(index==0 ){
                                    conBox.animate({"top":++tempTop},0,function(){
                                        if( conBox.css("top").replace("px","") >= 0){ for(var i=0;i<conBoxSize;i++){ conBox.children().last().prependTo(conBox); }conBox.css("top",-conBoxSize*slideH);}
                                    });
                            }
                            else{
                                    conBox.animate({"top":--tempTop},0,function(){
                                        if( conBox.css("top").replace("px","")<= -conBoxSize*slideH*2){ for(var i=0;i<conBoxSize;i++){ conBox.children().first().appendTo(conBox); }conBox.css("top",-conBoxSize*slideH);}
                                    });
                            }break;// topMarquee end


                }//switch end
                    navObj.removeClass(opts.titOnClassName).eq(index).addClass(opts.titOnClassName);
                    oldIndex=index;
            };

            doPlay();

            if (autoPlay) {
                    if( opts.effect=="leftMarquee" || opts.effect=="topMarquee"  ){
                        index++; inter = setInterval(doPlay, opts.interTime);
                        conBox.hover(function(){if(autoPlay){clearInterval(inter); }},function(){if(autoPlay){clearInterval(inter);inter = setInterval(doPlay, opts.interTime);}});
                    }else{
                         inter=setInterval(function(){index++; doPlay() }, opts.interTime);
                        $(this).hover(function(){if(autoPlay){clearInterval(inter); }},function(){if(autoPlay){clearInterval(inter); inter=setInterval(function(){index++; doPlay() }, opts.interTime); }});
                    }
            }

            var mst;
            if(opts.trigger=="onclick"){
                navObj.hover(function(){ clearTimeout(mst); index=navObj.index(this); mst = window.setTimeout(doPlay,200); }, function(){ if(!mst)clearTimeout(mst); });
            }else{ navObj.click(function(){index=navObj.index(this);  doPlay(); })  }
            nextBtn.click(function(){ index++; doPlay(); });
            prevBtn.click(function(){  index--; doPlay(); });

        });//each End

    };//slide End

})(jQuery);
jQuery(".aribox").slidehd({ mainCell:".bd ul",effect:"leftLoop",vis:1,scroll:1,autoPlay:true});
jQuery(".fivead").slidehd({ mainCell:".bd ul",effect:"leftLoop",vis:1,scroll:1,autoPlay:true});
/*活动滚动结束*/
$(".cooktag").live("click", function(){
	var tagvalue = $(this).html();
	var typevalue = $(this).attr("info");
	if($(this).hasClass('tied'))
	{
		dbclicktag(tagvalue);
		tageffect(tagvalue, 'del');
	}else
	{
		addTagInfo(tagvalue, typevalue);
	}
})

//输入框输入标签信息
/*
$("#taginfo").keyup(function(event){
	if(event.keyCode == 32)
	{
		var tagvalue = $.trim($(this).val());
		if(tagvalue.length > 0)
		{
			if(tagvalue.length <= 5)
			{
				$(this).val(' ');
				var typevalue = $(this).attr("info");
				addTagInfo(tagvalue, typevalue);
			}else
			{
				showerrorinfo('温馨提示', '标签太长了哦！');
			}
		}
	}
})
*/
//输入框输入标签信息
$("#taginfo").live('blur',function(event){
	var inputvalue = $.trim($(this).val());
	$(this).val(' ');
	var tagarr = inputvalue.split(' ');
	if(tagarr.length)
	{
		for(var i = 0 ; i < tagarr.length; i++)
		{
			var tagvalue = tagarr[i];
			if(tagvalue == '')continue;
			if(tagvalue.length > 0)
			{
				if(tagvalue.length <= 10)
				{
					$(this).val(' ');
					var typevalue = $(this).attr("info");
					addTagInfo(tagvalue, typevalue);
				}else
				{
					showerrorinfo('温馨提示', '标签太长了哦！');
				}
			}
		}
	}
	/*
	if(tagvalue.length > 0)
	{
		if(tagvalue.length <= 5)
		{
			$(this).val(' ');
			var typevalue = $(this).attr("info");
			addTagInfo(tagvalue, typevalue);
		}else
		{
			showerrorinfo('温馨提示', '标签太长了哦！');
		}
	}
	*/
})

/**
 * @desc: 循环添加标签信息
 * @param: string
**/
function addTagInfo(tag, type)
{
	var bool = checktaginfo(tag);
	if(bool)
	{
		tageffect(tag, 'add');
		if(type == 'cook')
		{
			var html = '<span class="mpad bime">'+tag+' <input type="hidden" name="tagname[]" value="'+tag+'"><a href="javascript:void(0);" class="ic_lcox"></a></span>';
		}else
		{
			var html = '<span class="mpad">'+tag+' <input type="hidden" name="tagname[]" value="'+tag+'"><a href="javascript:void(0);" class="ic_lcox"></a></span>';
		}
		$(".intput").before(html);
		$(this).addClass("tied");
	}
}

/**
 * @desc: 检查标签是否存在
 * @return: boolean
**/
function checktaginfo(tagname)
{
	var bool = false;
	var tagstr = $(".mpad").length;
	/*
	if(tagstr < 6)
	{
	*/
		if(tagstr > 0)
		{
			for(var i = 0; i < tagstr; i++)
	        {
				var tagvalue = $(".mpad").find("input").eq(i).val();
				if(tagvalue == tagname)
				{
					showerrorinfo('温馨提示', '不能重复添加！');
					return bool;
				}
	        }
			bool = true;
		}else
		{
			bool = true;
		}
	/*
	}else
	{
		showerrorinfo('温馨提示', '添加标签已达到上限！');
	}
	*/
	return bool;
}

/**
 * @desc: 添加标签不同效果
 * @return: null
**/
function tageffect(tagname, type)
{
	var tagstr = $(".cooktag").length;
	if(tagstr > 0)
	{
		for(var i = 0; i < tagstr; i++)
        {
			var tagvalue = $(".cooktag").eq(i).html();
			if(tagname == tagvalue)
			{
				if(type == 'add')
				{
					$(".cooktag").eq(i).addClass("tied");
				}else
				{
					$(".cooktag").eq(i).removeClass("tied");
				}
			}
        }
	}
}

/**
 * @desc:再次点击标签取消标签信息
 * @return: null
**/
function dbclicktag(tagname)
{
	var mpadstr = $(".mpad").length;
	if(mpadstr > 0)
	{
		for(var i = 0; i < mpadstr; i++)
        {
			var tagvalue = $(".mpad").find("input").eq(i).val();
			if(tagvalue == tagname)
			{
				$(".mpad").find("input").eq(i).parent().remove();
			}
        }
	}
}

/**
 * @desc: 获取标签信息
 * @return: 
**/
function gettaginfo()
{
	var taglen = $(".mpad").length;
	var tagvalue = '';
	if(taglen > 0)
	{
		for(var i = 0; i < taglen; i++)
        {
			var char = ((taglen - 1) == i) ? '' : ',';
			var tagval = $(".mpad").find("input").eq(i).val();
			tagvalue += tagval + char;
        }
	}
	return tagvalue;
}

/**
 * @desc: 删除标签信息
 * @return: boolean
**/
$(".ic_lcox").live("click", function(){
	var tagname = $(this).parent().find("input").val();
	//$("#taginfo").blur();
	tageffect(tagname,'del');
	$(this).parent().remove();
})
var conf={js:"1.1.0.3"};var $CONFIG={$lang:"zh",$oid:"",$uid:"",$passport:"",$token:"",$severtime:"",$PRODUCT_NAME:"",$pageid:"share",$appsrc:"cUcI1A",$refer:"www.douguo.com",$setDomain:false,$devMode:1};var STK=(function(){var D={};var A=[];D.inc=function(E,F){return true};D.register=function(G,I){var E=G.split(".");var J=D;var F=null;while(F=E.shift()){if(E.length){if(J[F]===undefined){J[F]={}}J=J[F]}else{if(J[F]===undefined){try{J[F]=I(D)}catch(H){A.push(H)}}}}};D.regShort=function(F,E){if(D[F]!==undefined){throw"["+F+"] : short : has been register"}D[F]=E};D.IE=/msie/i.test(navigator.userAgent);D.E=function(E){if(typeof E==="string"){return document.getElementById(E)}else{return E}};D.C=function(F){var E;F=F.toUpperCase();if(F=="TEXT"){E=document.createTextNode("")}else{if(F=="BUFFER"){E=document.createDocumentFragment()}else{E=document.createElement(F)}}return E};D.log=function(E){A.push("["+((new Date()).getTime()%100000)+"]: "+E)};D.getErrorLogInformationList=function(E){return A.splice(0,E||A.length)};return D})();$Import=STK.inc;STK.register("core.obj.parseParam",function(A){return function(D,G,F){var E,H={};G=G||{};for(E in D){H[E]=D[E];if(G[E]!=null){if(F){if(D.hasOwnProperty[E]){H[E]=G[E]}}else{H[E]=G[E]}}}return H}});STK.register("core.dom.getStyle",function(A){return function(H,I){if(A.IE){switch(I){case"opacity":var D=100;try{D=H.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(F){try{D=H.filters("alpha").opacity}catch(F){}}return D/100;case"float":I="styleFloat";default:var E=H.currentStyle?H.currentStyle[I]:null;return(H.style[I]||E)}}else{if(I=="float"){I="cssFloat"}try{var G=document.defaultView.getComputedStyle(H,"")}catch(F){}return H.style[I]||G?G[I]:null}}});STK.register("core.func.getType",function(A){return function(D){var E;return((E=typeof(D))=="object"?D==null&&"null"||Object.prototype.toString.call(D).slice(8,-1):E).toLowerCase()}});STK.register("core.arr.isArray",function(A){return function(D){return Object.prototype.toString.call(D)==="[object Array]"}});STK.register("core.arr.foreach",function(D){var E=function(J,K){var F=[];for(var H=0,I=J.length;H<I;H+=1){var G=K(J[H],H);if(G===false){break}else{if(G!==null){F[H]=G}}}return F};var A=function(F,H){var I={};for(var J in F){var G=H(F[J],J);if(G===false){break}else{if(G!==null){I[J]=G}}}return I};return function(G,F){if(D.core.arr.isArray(G)||(G.length&&G[0]!==undefined)){return E(G,F)}else{if(typeof G==="object"){return A(G,F)}}return null}});STK.register("core.arr.indexOf",function(A){return function(D,E){if(E.indexOf){return E.indexOf(D)}for(var G=0,F=E.length;G<F;G++){if(E[G]===D){return G}}return -1}});STK.register("core.arr.inArray",function(A){return function(D,E){return A.core.arr.indexOf(D,E)>-1}});STK.register("core.dom.isNode",function(A){return function(D){return(D!=undefined)&&Boolean(D.nodeName)&&Boolean(D.nodeType)}});STK.register("core.ani.tween",function(A){});STK.register("core.dom.hasClassName",function(A){return function(E,D){return(new RegExp("\\b"+D+"\\b").test(E.className))}});STK.register("core.dom.addClassName",function(A){return function(E,D){if(E.nodeType===1){if(!A.core.dom.hasClassName(E,D)){E.className+=(" "+D)}}}});STK.register("core.dom.addHTML",function(A){return function(D,G){if(A.IE){D.insertAdjacentHTML("BeforeEnd",G)}else{var E=D.ownerDocument.createRange();E.setStartBefore(D);var F=E.createContextualFragment(G);D.appendChild(F)}}});STK.register("core.dom.sizzle",function(K){var G=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,M=0,S=Object.prototype.toString,D=false,I=true;[0,0].sort(function(){I=false;return 0});var N=function(m,V,c,i){c=c||[];V=V||document;var g=V;if(V.nodeType!==1&&V.nodeType!==9){return[]}if(!m||typeof m!=="string"){return c}var f=[],U,Y,X,T,o=true,n=N.isXML(V),j=m,h,W,Z,b;do{G.exec("");U=G.exec(j);if(U){j=U[3];f.push(U[1]);if(U[2]){T=U[3];break}}}while(U);if(f.length>1&&L.exec(m)){if(f.length===2&&Q.relative[f[0]]){Y=J(f[0]+f[1],V)}else{Y=Q.relative[f[0]]?[V]:N(f.shift(),V);while(f.length){m=f.shift();if(Q.relative[m]){m+=f.shift()}Y=J(m,Y)}}}else{if(!i&&f.length>1&&V.nodeType===9&&!n&&Q.match.ID.test(f[0])&&!Q.match.ID.test(f[f.length-1])){h=N.find(f.shift(),V,n);V=h.expr?N.filter(h.expr,h.set)[0]:h.set[0]}if(V){h=i?{expr:f.pop(),set:P(i)}:N.find(f.pop(),f.length===1&&(f[0]==="~"||f[0]==="+")&&V.parentNode?V.parentNode:V,n);Y=h.expr?N.filter(h.expr,h.set):h.set;if(f.length>0){X=P(Y)}else{o=false}while(f.length){W=f.pop();Z=W;if(!Q.relative[W]){W=""}else{Z=f.pop()}if(Z==null){Z=V}Q.relative[W](X,Z,n)}}else{X=f=[]}}if(!X){X=Y}if(!X){N.error(W||m)}if(S.call(X)==="[object Array]"){if(!o){c.push.apply(c,X)}else{if(V&&V.nodeType===1){for(b=0;X[b]!=null;b++){if(X[b]&&(X[b]===true||X[b].nodeType===1&&N.contains(V,X[b]))){c.push(Y[b])}}}else{for(b=0;X[b]!=null;b++){if(X[b]&&X[b].nodeType===1){c.push(Y[b])}}}}}else{P(X,c)}if(T){N(T,g,c,i);N.uniqueSort(c)}return c};N.uniqueSort=function(U){if(O){D=I;U.sort(O);if(D){for(var T=1;T<U.length;T++){if(U[T]===U[T-1]){U.splice(T--,1)}}}}return U};N.matches=function(T,U){return N(T,null,null,U)};N.find=function(W,T,X){var Y;if(!W){return[]}for(var b=0,V=Q.order.length;b<V;b++){var Z=Q.order[b],c;if((c=Q.leftMatch[Z].exec(W))){var U=c[1];c.splice(1,1);if(U.substr(U.length-1)!=="\\"){c[1]=(c[1]||"").replace(/\\/g,"");Y=Q.find[Z](c,T,X);if(Y!=null){W=W.replace(Q.match[Z],"");break}}}}if(!Y){Y=T.getElementsByTagName("*")}return{set:Y,expr:W}};N.filter=function(g,j,Z,o){var U=g,X=[],c=j,f,V,b=j&&j[0]&&N.isXML(j[0]);while(g&&j.length){for(var i in Q.filter){if((f=Q.leftMatch[i].exec(g))!=null&&f[2]){var T=Q.filter[i],W,Y,n=f[1];V=false;f.splice(1,1);if(n.substr(n.length-1)==="\\"){continue}if(c===X){X=[]}if(Q.preFilter[i]){f=Q.preFilter[i](f,c,Z,X,o,b);if(!f){V=W=true}else{if(f===true){continue}}}if(f){for(var m=0;(Y=c[m])!=null;m++){if(Y){W=T(Y,f,m,c);var h=o^!!W;if(Z&&W!=null){if(h){V=true}else{c[m]=false}}else{if(h){X.push(Y);V=true}}}}}if(W!==undefined){if(!Z){c=X}g=g.replace(Q.match[i],"");if(!V){return[]}break}}}if(g===U){if(V==null){N.error(g)}else{break}}U=g}return c};N.error=function(T){throw"Syntax error, unrecognized expression: "+T};var Q={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(T){return T.getAttribute("href")}},relative:{"+":function(X,U){var Z=typeof U==="string",Y=Z&&!/\W/.test(U),W=Z&&!Y;if(Y){U=U.toLowerCase()}for(var V=0,T=X.length,b;V<T;V++){if((b=X[V])){while((b=b.previousSibling)&&b.nodeType!==1){}X[V]=W||b&&b.nodeName.toLowerCase()===U?b||false:b===U}}if(W){N.filter(U,X,true)}},">":function(Z,V){var X=typeof V==="string",U,W=0,T=Z.length;if(X&&!/\W/.test(V)){V=V.toLowerCase();for(;W<T;W++){U=Z[W];if(U){var Y=U.parentNode;Z[W]=Y.nodeName.toLowerCase()===V?Y:false}}}else{for(;W<T;W++){U=Z[W];if(U){Z[W]=X?U.parentNode:U.parentNode===V}}if(X){N.filter(V,Z,true)}}},"":function(W,V,U){var X=M++,T=H,Y;if(typeof V==="string"&&!/\W/.test(V)){V=V.toLowerCase();Y=V;T=A}T("parentNode",V,X,W,Y,U)},"~":function(W,V,U){var X=M++,T=H,Y;if(typeof V==="string"&&!/\W/.test(V)){V=V.toLowerCase();Y=V;T=A}T("previousSibling",V,X,W,Y,U)}},find:{ID:function(U,V,W){if(typeof V.getElementById!=="undefined"&&!W){var T=V.getElementById(U[1]);return T?[T]:[]}},NAME:function(W,U){if(typeof U.getElementsByName!=="undefined"){var V=[],X=U.getElementsByName(W[1]);for(var Y=0,T=X.length;Y<T;Y++){if(X[Y].getAttribute("name")===W[1]){V.push(X[Y])}}return V.length===0?null:V}},TAG:function(T,U){return U.getElementsByTagName(T[1])}},preFilter:{CLASS:function(Z,U,V,T,X,W){Z=" "+Z[1].replace(/\\/g,"")+" ";if(W){return Z}for(var b=0,Y;(Y=U[b])!=null;b++){if(Y){if(X^(Y.className&&(" "+Y.className+" ").replace(/[\t\n]/g," ").indexOf(Z)>=0)){if(!V){T.push(Y)}}else{if(V){U[b]=false}}}}return false},ID:function(T){return T[1].replace(/\\/g,"")},TAG:function(U,T){return U[1].toLowerCase()},CHILD:function(T){if(T[1]==="nth"){var U=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(T[2]==="even"&&"2n"||T[2]==="odd"&&"2n+1"||!/\D/.test(T[2])&&"0n+"+T[2]||T[2]);T[2]=(U[1]+(U[2]||1))-0;T[3]=U[3]-0}T[0]=M++;return T},ATTR:function(X,V,W,T,U,Z){var Y=X[1].replace(/\\/g,"");if(!Z&&Q.attrMap[Y]){X[1]=Q.attrMap[Y]}if(X[2]==="~="){X[4]=" "+X[4]+" "}return X},PSEUDO:function(X,V,W,T,U){if(X[1]==="not"){if((G.exec(X[3])||"").length>1||/^\w/.test(X[3])){X[3]=N(X[3],null,null,V)}else{var Y=N.filter(X[3],V,W,true^U);if(!W){T.push.apply(T,Y)}return false}}else{if(Q.match.POS.test(X[0])||Q.match.CHILD.test(X[0])){return true}}return X},POS:function(T){T.unshift(true);return T}},filters:{enabled:function(T){return T.disabled===false&&T.type!=="hidden"},disabled:function(T){return T.disabled===true},checked:function(T){return T.checked===true},selected:function(T){T.parentNode.selectedIndex;return T.selected===true},parent:function(T){return !!T.firstChild},empty:function(T){return !T.firstChild},has:function(V,U,T){return !!N(T[3],V).length},header:function(T){return(/h\d/i).test(T.nodeName)},text:function(T){return"text"===T.type},radio:function(T){return"radio"===T.type},checkbox:function(T){return"checkbox"===T.type},file:function(T){return"file"===T.type},password:function(T){return"password"===T.type},submit:function(T){return"submit"===T.type},image:function(T){return"image"===T.type},reset:function(T){return"reset"===T.type},button:function(T){return"button"===T.type||T.nodeName.toLowerCase()==="button"},input:function(T){return(/input|select|textarea|button/i).test(T.nodeName)}},setFilters:{first:function(U,T){return T===0},last:function(V,U,T,W){return U===W.length-1},even:function(U,T){return T%2===0},odd:function(U,T){return T%2===1},lt:function(V,U,T){return U<T[3]-0},gt:function(V,U,T){return U>T[3]-0},nth:function(V,U,T){return T[3]-0===U},eq:function(V,U,T){return T[3]-0===U}},filter:{PSEUDO:function(V,W,Y,X){var T=W[1],U=Q.filters[T];if(U){return U(V,Y,W,X)}else{if(T==="contains"){return(V.textContent||V.innerText||N.getText([V])||"").indexOf(W[3])>=0}else{if(T==="not"){var b=W[3];for(var Z=0,c=b.length;Z<c;Z++){if(b[Z]===V){return false}}return true}else{N.error("Syntax error, unrecognized expression: "+T)}}}},CHILD:function(T,c){var Y=c[1],U=T;switch(Y){case"only":case"first":while((U=U.previousSibling)){if(U.nodeType===1){return false}}if(Y==="first"){return true}U=T;case"last":while((U=U.nextSibling)){if(U.nodeType===1){return false}}return true;case"nth":var V=c[2],Z=c[3];if(V===1&&Z===0){return true}var b=c[0],X=T.parentNode;if(X&&(X.sizcache!==b||!T.nodeIndex)){var f=0;for(U=X.firstChild;U;U=U.nextSibling){if(U.nodeType===1){U.nodeIndex=++f}}X.sizcache=b}var W=T.nodeIndex-Z;if(V===0){return W===0}else{return(W%V===0&&W/V>=0)}}},ID:function(U,T){return U.nodeType===1&&U.getAttribute("id")===T},TAG:function(U,T){return(T==="*"&&U.nodeType===1)||U.nodeName.toLowerCase()===T},CLASS:function(U,T){return(" "+(U.className||U.getAttribute("class"))+" ").indexOf(T)>-1},ATTR:function(U,W){var X=W[1],T=Q.attrHandle[X]?Q.attrHandle[X](U):U[X]!=null?U[X]:U.getAttribute(X),Z=T+"",Y=W[2],V=W[4];return T==null?Y==="!=":Y==="="?Z===V:Y==="*="?Z.indexOf(V)>=0:Y==="~="?(" "+Z+" ").indexOf(V)>=0:!V?Z&&T!==false:Y==="!="?Z!==V:Y==="^="?Z.indexOf(V)===0:Y==="$="?Z.substr(Z.length-V.length)===V:Y==="|="?Z===V||Z.substr(0,V.length+1)===V+"-":false},POS:function(X,V,W,U){var T=V[2],Y=Q.setFilters[T];if(Y){return Y(X,W,V,U)}}}};N.selectors=Q;var L=Q.match.POS,R=function(U,T){return"\\"+(T-0+1)};for(var F in Q.match){Q.match[F]=new RegExp(Q.match[F].source+(/(?![^\[]*\])(?![^\(]*\))/.source));Q.leftMatch[F]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Q.match[F].source.replace(/\\(\d+)/g,R))}var P=function(U,T){U=Array.prototype.slice.call(U,0);if(T){T.push.apply(T,U);return T}return U};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(E){P=function(W,V){var U=V||[],X=0;if(S.call(W)==="[object Array]"){Array.prototype.push.apply(U,W)}else{if(typeof W.length==="number"){for(var T=W.length;X<T;X++){U.push(W[X])}}else{for(;W[X];X++){U.push(W[X])}}}return U}}var O;if(document.documentElement.compareDocumentPosition){O=function(U,T){if(!U.compareDocumentPosition||!T.compareDocumentPosition){if(U==T){D=true}return U.compareDocumentPosition?-1:1}var V=U.compareDocumentPosition(T)&4?-1:U===T?0:1;if(V===0){D=true}return V}}else{if("sourceIndex" in document.documentElement){O=function(U,T){if(!U.sourceIndex||!T.sourceIndex){if(U==T){D=true}return U.sourceIndex?-1:1}var V=U.sourceIndex-T.sourceIndex;if(V===0){D=true}return V}}else{if(document.createRange){O=function(V,U){if(!V.ownerDocument||!U.ownerDocument){if(V==U){D=true}return V.ownerDocument?-1:1}var W=V.ownerDocument.createRange(),T=U.ownerDocument.createRange();W.setStart(V,0);W.setEnd(V,0);T.setStart(U,0);T.setEnd(U,0);var X=W.compareBoundaryPoints(Range.START_TO_END,T);if(X===0){D=true}return X}}}}N.getText=function(T){var U="",V;for(var W=0;T[W];W++){V=T[W];if(V.nodeType===3||V.nodeType===4){U+=V.nodeValue}else{if(V.nodeType!==8){U+=N.getText(V.childNodes)}}}return U};(function(){var U=document.createElement("div"),V="script"+(new Date()).getTime();U.innerHTML="<a name='"+V+"'/>";var T=document.documentElement;T.insertBefore(U,T.firstChild);if(document.getElementById(V)){Q.find.ID=function(Y,W,Z){if(typeof W.getElementById!=="undefined"&&!Z){var X=W.getElementById(Y[1]);return X?X.id===Y[1]||typeof X.getAttributeNode!=="undefined"&&X.getAttributeNode("id").nodeValue===Y[1]?[X]:undefined:[]}};Q.filter.ID=function(W,X){var Y=typeof W.getAttributeNode!=="undefined"&&W.getAttributeNode("id");return W.nodeType===1&&Y&&Y.nodeValue===X}}T.removeChild(U);T=U=null})();(function(){var T=document.createElement("div");T.appendChild(document.createComment(""));if(T.getElementsByTagName("*").length>0){Q.find.TAG=function(V,U){var X=U.getElementsByTagName(V[1]);if(V[1]==="*"){var W=[];for(var Y=0;X[Y];Y++){if(X[Y].nodeType===1){W.push(X[Y])}}X=W}return X}}T.innerHTML="<a href='#'></a>";if(T.firstChild&&typeof T.firstChild.getAttribute!=="undefined"&&T.firstChild.getAttribute("href")!=="#"){Q.attrHandle.href=function(U){return U.getAttribute("href",2)}}T=null})();if(document.querySelectorAll){(function(){var T=N,V=document.createElement("div");V.innerHTML="<p class='TEST'></p>";if(V.querySelectorAll&&V.querySelectorAll(".TEST").length===0){return}N=function(b,W,Y,Z){W=W||document;if(!Z&&W.nodeType===9&&!N.isXML(W)){try{return P(W.querySelectorAll(b),Y)}catch(X){}}return T(b,W,Y,Z)};for(var U in T){N[U]=T[U]}V=null})()}(function(){var T=document.createElement("div");T.innerHTML="<div class='test e'></div><div class='test'></div>";if(!T.getElementsByClassName||T.getElementsByClassName("e").length===0){return}T.lastChild.className="e";if(T.getElementsByClassName("e").length===1){return}Q.order.splice(1,0,"CLASS");Q.find.CLASS=function(U,V,W){if(typeof V.getElementsByClassName!=="undefined"&&!W){return V.getElementsByClassName(U[1])}};T=null})();function A(U,Y,b,Z,W,X){for(var c=0,V=Z.length;c<V;c++){var T=Z[c];if(T){T=T[U];var f=false;while(T){if(T.sizcache===b){f=Z[T.sizset];break}if(T.nodeType===1&&!X){T.sizcache=b;T.sizset=c}if(T.nodeName.toLowerCase()===Y){f=T;break}T=T[U]}Z[c]=f}}}function H(U,Y,b,Z,W,X){for(var c=0,V=Z.length;c<V;c++){var T=Z[c];if(T){T=T[U];var f=false;while(T){if(T.sizcache===b){f=Z[T.sizset];break}if(T.nodeType===1){if(!X){T.sizcache=b;T.sizset=c}if(typeof Y!=="string"){if(T===Y){f=true;break}}else{if(N.filter(Y,[T]).length>0){f=T;break}}}T=T[U]}Z[c]=f}}}N.contains=document.compareDocumentPosition?function(U,T){return !!(U.compareDocumentPosition(T)&16)}:function(U,T){return U!==T&&(U.contains?U.contains(T):true)};N.isXML=function(T){var U=(T?T.ownerDocument||T:0).documentElement;return U?U.nodeName!=="HTML":false};var J=function(T,W){var Z=[],b="",Y,V=W.nodeType?[W]:W;while((Y=Q.match.PSEUDO.exec(T))){b+=Y[0];T=T.replace(Q.match.PSEUDO,"")}T=Q.relative[T]?T+"*":T;for(var X=0,U=V.length;X<U;X++){N(T,V[X],Z)}return N.filter(b,Z)};return N});STK.register("core.dom.builder",function(D){function A(H,J){if(J){return J}var E,G=/\<(\w+)[^>]*\s+node-type\s*=\s*([\'\"])?(\w+)\2.*?>/g;var K={};var F,L,I;while((E=G.exec(H))){L=E[1];F=E[3];I=L+"[node-type="+F+"]";K[F]=K[F]==null?[]:K[F];if(!D.core.arr.inArray(I,K[F])){K[F].push(L+"[node-type="+F+"]")}}return K}return function(L,K){var J=D.core.func.getType(L)=="string";var I=A(J?L:L.innerHTML,K);var M=L;if(J){M=D.C("div");M.innerHTML=L}var H,F,G;G=D.core.dom.sizzle("[node-type]",M);F={};for(H in I){F[H]=D.core.dom.sizzle.matches(I[H].toString(),G)}var E=L;if(J){E=D.C("buffer");while(M.children[0]){E.appendChild(M.children[0])}}return{box:E,list:F}}});STK.register("core.dom.removeClassName",function(A){return function(E,D){if(E.nodeType===1){if(A.core.dom.hasClassName(E,D)){E.className=E.className.replace(new RegExp("\\b"+D+"\\b")," ")}}}});STK.register("core.dom.trimNode",function(A){return function(F){var D=F.childNodes;for(var E=0;E<D.length;E++){if(D[E].nodeType==3||D[E].nodeType==8){F.removeChild(D[E])}}}});STK.register("core.dom.removeNode",function(A){return function(D){D=A.E(D)||D;try{D.parentNode.removeChild(D)}catch(E){}}});STK.register("core.evt.addEvent",function(A){return function(F,E,D){var G=A.E(F);if(G==null){return false}E=E||"click";if((typeof D).toLowerCase()!="function"){return}if(G.addEventListener){G.addEventListener(E,D,false)}else{if(G.attachEvent){G.attachEvent("on"+E,D)}else{G["on"+E]=D}}return true}});STK.register("core.evt.removeEvent",function(A){return function(G,E,D,F){var H=A.E(G);if(H==null){return false}if(typeof D!="function"){return false}if(H.removeEventListener){H.removeEventListener(E,D,F)}else{if(H.detachEvent){H.detachEvent("on"+E,D)}else{H["on"+E]=null}}return true}});STK.register("core.util.scrollPos",function(A){return function(D){D=D||document;var E=D.documentElement;var F=D.body;return{top:Math.max(window.pageYOffset||0,E.scrollTop,F.scrollTop),left:Math.max(window.pageXOffset||0,E.scrollLeft,F.scrollLeft)}}});STK.register("core.util.browser",function(A){return true});STK.register("core.dom.position",function(D){var E=function(F){var G,L,H,I,J,K;G=F.getBoundingClientRect();L=D.core.util.scrollPos();H=F.ownerDocument.body;I=F.ownerDocument.documentElement;J=I.clientTop||H.clientTop||0;K=I.clientLeft||H.clientLeft||0;return{l:parseInt(G.left+L.left-K,10)||0,t:parseInt(G.top+L.top-J,10)||0}};var A=function(G,F){var H;H=[G.offsetLeft,G.offsetTop];parent=G.offsetParent;if(parent!==G&&parent!==F){while(parent){H[0]+=parent.offsetLeft;H[1]+=parent.offsetTop;parent=parent.offsetParent}}if(D.core.util.browser.OPERA!=-1||(D.core.util.browser.SAFARI!=-1&&G.style.position=="absolute")){H[0]-=document.body.offsetLeft;H[1]-=document.body.offsetTop}if(G.parentNode){parent=G.parentNode}else{parent=null}while(parent&&!/^body|html$/i.test(parent.tagName)&&parent!==F){if(parent.style.display.search(/^inline|table-row.*$/i)){H[0]-=parent.scrollLeft;H[1]-=parent.scrollTop}parent=parent.parentNode}return{l:parseInt(H[0],10),t:parseInt(H[1],10)}};return function(J,G){if(J==document.body){return false}if(J.parentNode==null){return false}if(J.style.display=="none"){return false}var H=D.core.obj.parseParam({parent:null},G);if(J.getBoundingClientRect){if(H.parent){var F=E(J);var I=E(H.parent);return{l:F.l-I.l,t:F.t-I.t}}else{return E(J)}}else{return A(J,H.parent||document.body)}}});STK.register("core.dom.contains",function(A){return function(D,E){if(D===E){return false}else{if(D.compareDocumentPosition){return((D.compareDocumentPosition(E)&16)===16)}else{if(D.contains&&E.nodeType===1){return D.contains(E)}else{while(E=E.parentNode){if(D===E){return true}}}}}return false}});STK.register("core.dom.ready",function(M){var J=[];var G=false;var F=M.core.func.getType;var E=M.core.util.browser;var L=M.core.evt.addEvent;var D=function(){if(!G){if(document.readyState==="complete"){return true}}return G};var N=function(){if(G==true){return}G=true;for(var Q=0,P=J.length;Q<P;Q++){if(F(J[Q])==="function"){try{J[Q].call()}catch(O){}}}J=[]};var K=function(){if(D()){N();return}try{document.documentElement.doScroll("left")}catch(O){setTimeout(arguments.callee,25);return}N()};var I=function(){if(D()){N();return}setTimeout(arguments.callee,25)};var A=function(){L(document,"DOMContentLoaded",N)};var H=function(){L(window,"load",N)};if(!D()){if(M.IE&&window===window.top){K()}A();I();H()}return function(O){if(D()){if(F(O)==="function"){O.call()}}else{J.push(O)}}});STK.register("core.dom.selector",function(D){var A=function(F,J,E,G){var H=[];if(typeof F==="string"){lis=D.core.dom.sizzle(F,J,E,G);for(var K=0,I=lis.length;K<I;K+=1){H[K]=lis[K]}}else{if(D.core.dom.isNode(F)){if(J){if(D.core.dom.contains(J,F)){H=[F]}}else{H=[F]}}else{if(D.core.arr.isArray(F)){if(J){for(var K=0,I=F.length;K<I;K+=1){if(D.core.dom.contains(J,F[K])){H.push(F[K])}}}else{H=F}}}}return H};return function(H,I,G,F){var E=A.apply(window,arguments);E.on=function(K,L){for(var M=0,J=E.length;M<J;M+=1){D.core.evt.addEvent(E[M],K,L)}return E};E.css=function(K,M){for(var L=0,J=E.length;L<J;L+=1){D.core.dom.setStyle(E[L],K,M)}return E};E.show=function(){for(var K=0,J=E.length;K<J;K+=1){E[K].style.display=""}return E};E.hidd=function(){for(var K=0,J=E.length;K<J;K+=1){E[K].style.display="none"}return E};E.hide=E.hidd;return E}});STK.register("core.evt.custEvent",function(F){var G="__custEventKey__",A=1,D={},E=function(H,I){var J=(typeof H=="number")?H:H[G];return(J&&D[J])&&{obj:(typeof I=="string"?D[J][I]:D[J]),key:J}};return{define:function(J,H){if(J&&H){var I=(typeof J=="number")?J:J[G]||(J[G]=A++),K=D[I]||(D[I]={});H=[].concat(H);for(var L=0;L<H.length;L++){K[H[L]]||(K[H[L]]=[])}return I}},undefine:function(J,H){if(J){var I=(typeof J=="number")?J:J[G];if(I&&D[I]){if(H){H=[].concat(H);for(var K=0;K<H.length;K++){if(H[K] in D[I]){delete D[I][H[K]]}}}else{delete D[I]}}}},add:function(J,H,L,I){if(J&&typeof H=="string"&&L){var K=E(J,H);if(!K||!K.obj){throw"custEvent ("+H+") is undefined !"}K.obj.push({fn:L,data:I});return K.key}},once:function(J,H,L,I){if(J&&typeof H=="string"&&L){var K=E(J,H);if(!K||!K.obj){throw"custEvent ("+H+") is undefined !"}K.obj.push({fn:L,data:I,once:true});return K.key}},remove:function(I,M,H){if(I){var L=E(I,M),J,N;if(L&&(J=L.obj)){if(F.core.arr.isArray(J)){if(H){var K=0;while(J[K]){if(J[K].fn===H){break}K++}J.splice(K,1)}else{J.splice(0,J.length)}}else{for(var K in J){J[K]=[]}}return L.key}}},fire:function(P,H,L){if(P&&typeof H=="string"){var O=E(P,H),N;if(O&&(N=O.obj)){if(!F.core.arr.isArray(L)){L=L!=undefined?[L]:[]}for(var K=N.length-1;K>-1&&N[K];K--){var I=N[K].fn;var M=N[K].once;if(I&&I.apply){try{I.apply(P,[{type:H,data:N[K].data}].concat(L));if(M){N.splice(K,1)}}catch(J){F.log("[error][custEvent]"+J.message)}}}return O.key}}},destroy:function(){D={};A=1}}});STK.register("core.str.trim",function(A){return function(E){if(typeof E!=="string"){throw"trim need a string as parameter"}var F=E.length;var D=0;var G=/(\u3000|\s|\t|\u00A0)/;while(D<F){if(!G.test(E.charAt(D))){break}D+=1}while(F>D){if(!G.test(E.charAt(F-1))){break}F-=1}return E.slice(D,F)}});STK.register("core.json.queryToJson",function(A){return function(M,F){var H=A.core.str.trim(M).split("&");var E={};var J=function(N){if(F){return decodeURIComponent(N)}else{return N}};for(var K=0,L=H.length;K<L;K++){if(H[K]){var D=H[K].split("=");var I=D[0];var G=D[1];if(D.length<2){G=I;I="$nullName"}if(!E[I]){E[I]=J(G)}else{if(A.core.arr.isArray(E[I])!=true){E[I]=[E[I]]}E[I].push(J(G))}}}return E}});STK.register("core.evt.getEvent",function(A){return function(){if(A.IE){return window.event}else{if(window.event){return window.event}var F=arguments.callee.caller;var E;var D=0;while(F!=null&&D<40){E=F.arguments[0];if(E&&(E.constructor==Event||E.constructor==MouseEvent||E.constructor==KeyboardEvent)){return E}D++;F=F.caller}return E}}});STK.register("core.evt.fixEvent",function(A){return function(D){D=D||A.core.evt.getEvent();if(!D.target){D.target=D.srcElement;D.pageX=D.x;D.pageY=D.y}if(typeof D.layerX=="undefined"){D.layerX=D.offsetX}if(typeof D.layerY=="undefined"){D.layerY=D.offsetY}return D}});STK.register("core.obj.isEmpty",function(A){return function(E,D){var G=true;for(var F in E){if(D){G=false;break}else{if(E.hasOwnProperty(F)){G=false;break}}}return G}});STK.register("core.evt.delegatedEvent",function(A){var D=function(H,F){for(var E=0,G=H.length;E<G;E+=1){if(A.core.dom.contains(H[E],F)){return true}}return false};return function(F,E){if(!A.core.dom.isNode(F)){throw"core.evt.delegatedEvent need an Element as first Parameter"}if(!E){E=[]}if(A.core.arr.isArray(E)){E=[E]}var H={};var I=function(L){var P=A.core.evt.fixEvent(L);var M=P.target;var K=L.type;var N=function(){var S,Q,R;S=M.getAttribute("action-target");if(S){Q=A.core.dom.sizzle(S,F);if(Q.length){R=P.target=Q[0]}}N=A.core.func.empty;return R};var J=function(){var Q=N()||M;if(H[K]&&H[K][O]){return H[K][O]({evt:P,el:Q,box:F,data:A.core.json.queryToJson(Q.getAttribute("action-data")||"")})}else{return true}};if(D(E,M)){return false}else{if(!A.core.dom.contains(F,M)){return false}else{var O=null;while(M&&M!==F){O=M.getAttribute("action-type");if(O&&J()===false){break}M=M.parentNode}}}};var G={};G.add=function(L,K,M){if(!H[K]){H[K]={};A.core.evt.addEvent(F,K,I)}var J=H[K];J[L]=M};G.remove=function(J,K){if(H[K]){delete H[K][J];if(A.core.obj.isEmpty(H[K])){delete H[K];A.core.evt.removeEvent(F,K,I)}}};G.pushExcept=function(J){E.push(J)};G.removeExcept=function(K){if(!K){E=[]}else{for(var L=0,J=E.length;L<J;L+=1){if(E[L]===K){E.splice(L,1)}}}};G.clearExcept=function(J){E=[]};G.destroy=function(){for(k in H){for(l in H[k]){delete H[k][l]}delete H[k];A.core.evt.removeEvent(F,k,I)}};return G}});STK.register("core.evt.getActiveElement",function(A){});STK.register("core.evt.hitTest",function(A){});STK.register("core.evt.stopEvent",function(A){return function(E){var D=E?E:A.core.evt.getEvent();if(A.IE){D.cancelBubble=true;D.returnValue=false}else{D.preventDefault();D.stopPropagation()}return false}});STK.register("core.evt.preventDefault",function(A){return function(E){var D=E?E:A.core.evt.getEvent();if(A.IE){D.returnValue=false}else{D.preventDefault()}}});STK.register("core.evt.hotKey",function(A){return true});STK.register("core.func.bind",function(A){return function(D,E,F){F=A.core.arr.isArray(F)?F:[F];return function(){return E.apply(D,F)}}});STK.register("core.func.memorize",function(A){});STK.register("core.func.methodBefore",function(A){return function(){var E=false;var D=[];var F={};F.add=function(G,I){var H=A.core.obj.parseParam({args:[],pointer:window,top:false},I);if(H.top==true){D.unshift([G,H.args,H.pointer])}else{D.push([G,H.args,H.pointer])}return !E};F.start=function(){var G,I,J,K,H;if(E==true){return}E=true;for(G=0,I=D.length;G<I;G++){J=D[G][0];K=D[G][1];H=D[G][2];J.apply(H,K)}};F.reset=function(){D=[];E=false};F.getList=function(){return D};return F}});STK.register("core.func.timedChunk",function(A){var D={process:function(E){if(typeof E==="function"){E()}},context:{},callback:null,delay:25,execTime:50};return function(G,E){if(!A.core.arr.isArray(G)){throw"core.func.timedChunk need an array as first parameter"}var I=G.concat();var J=A.core.obj.parseParam(D,E);var F=null;var H=function(){var K=+new Date();do{J.process.call(J.context,I.shift())}while(I.length>0&&(+new Date()-K<J.execTime));if(I.length<=0){if(J.callback){J.callback(G)}}else{setTimeout(arguments.callee,J.delay)}};F=setTimeout(H,J.delay)}});STK.register("core.io.getXHR",function(A){return function(){var E=false;try{E=new XMLHttpRequest()}catch(D){try{E=new ActiveXObject("Msxml2.XMLHTTP")}catch(G){try{E=new ActiveXObject("Microsoft.XMLHTTP")}catch(F){E=false}}}return E}});STK.register("core.str.parseURL",function(A){return function(E){var I=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;var D=["url","scheme","slash","host","port","path","query","hash"];var J=I.exec(E);var F={};for(var G=0,H=D.length;G<H;G+=1){F[D[G]]=J[G]||""}return F}});STK.register("core.json.jsonToQuery",function(D){var A=function(E,F){E=E==null?"":E;E=D.core.str.trim(E.toString());if(F){return encodeURIComponent(E)}else{return E}};return function(E,G){var F=[];if(typeof E=="object"){for(var H in E){if(H==="$nullName"){F=F.concat(E[H]);continue}if(E[H] instanceof Array){for(var J=0,I=E[H].length;J<I;J++){F.push(H+"="+A(E[H][J],G))}}else{if(typeof E[H]!="function"){F.push(H+"="+A(E[H],G))}}}}if(F.length){return F.join("&")}else{return""}}});STK.register("core.util.URL",function(A){return function(J,I){var F=A.core.obj.parseParam({isEncodeQuery:false,isEncodeHash:false},I||{});var E={};var D=A.core.str.parseURL(J);var H=A.core.json.queryToJson(D.query);var G=A.core.json.queryToJson(D.hash);E.setParam=function(L,K){H[L]=K;return this};E.getParam=function(K){return H[K]};E.setParams=function(K){for(var L in K){E.setParam(L,K[L])}return this};E.setHash=function(L,K){G[L]=K;return this};E.getHash=function(K){return G[K]};E.valueOf=E.toString=function(){var M=[];var L=A.core.json.jsonToQuery(H,F.isEncodeQuery);var K=A.core.json.jsonToQuery(G,F.isEncodeQuery);if(D.scheme!=""){M.push(D.scheme+":");M.push(D.slash)}if(D.host!=""){M.push(D.host);if(D.port!=""){M.push(":");M.push(D.port)}}M.push("/");M.push(D.path);if(L!=""){M.push("?"+L)}if(K!=""){M.push("#"+K)}return M.join("")};return E}});STK.register("core.io.ajax",function($){return function(oOpts){var opts=$.core.obj.parseParam({url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:$.core.func.empty,uniqueID:null,onFail:$.core.func.empty,method:"get",asynchronous:true,header:{},isEncode:false,responseType:"json"},oOpts);if(opts.url==""){throw"ajax need url in parameters object"}var tm;var trans=$.core.io.getXHR();var cback=function(){if(trans.readyState==4){clearTimeout(tm);var data="";if(opts.responseType==="xml"){data=trans.responseXML}else{if(opts.responseType==="text"){data=trans.responseText}else{try{if(trans.responseText&&typeof trans.responseText==="string"){data=eval("("+trans.responseText+")")}else{data={}}}catch(exp){data=opts.url+"return error : data error"}}}if(trans.status==200){if(opts.onComplete!=null){opts.onComplete(data)}}else{if(trans.status==0){}else{if(opts.onFail!=null){opts.onFail(data,trans)}}}}else{if(opts.onTraning!=null){opts.onTraning(trans)}}};trans.onreadystatechange=cback;if(!opts.header["Content-Type"]){opts.header["Content-Type"]="application/x-www-form-urlencoded"}if(!opts.header["X-Requested-With"]){opts.header["X-Requested-With"]="XMLHttpRequest"}if(opts.method.toLocaleLowerCase()=="get"){var url=$.core.util.URL(opts.url,{isEncodeQuery:opts.isEncode});url.setParams(opts.args);url.setParam("__rnd",new Date().valueOf());trans.open(opts.method,url,opts.asynchronous);try{for(var k in opts.header){trans.setRequestHeader(k,opts.header[k])}}catch(exp){}trans.send("")}else{trans.open(opts.method,opts.url,opts.asynchronous);try{for(var k in opts.header){trans.setRequestHeader(k,opts.header[k])}}catch(exp){}trans.send($.core.json.jsonToQuery(opts.args,opts.isEncode))}if(opts.timeout){tm=setTimeout(function(){try{trans.abort()}catch(exp){}opts.onTimeout({},trans);opts.onFail(data,trans)},opts.timeout)}return trans}});STK.register("core.json.compare",function(A){return function(E,D){if(A.core.json.include(E,D)&&A.core.json.include(D,E)){return true}else{return false}}});STK.register("core.json.jsonToStr",function(L){function A(M){return M<10?"0"+M:M}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(M){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+A(this.getUTCMonth()+1)+"-"+A(this.getUTCDate())+"T"+A(this.getUTCHours())+":"+A(this.getUTCMinutes())+":"+A(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(M){return this.valueOf()}}var I=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,E=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,D,H,F={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},G;function J(M){E.lastIndex=0;return E.test(M)?'"'+M.replace(E,function(N){var O=F[N];return typeof O==="string"?O:"\\u"+("0000"+N.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+M+'"'}function K(S,M){var O,T,Q,U,N=D,P,R=M[S];if(R&&typeof R==="object"&&typeof R.toJSON==="function"){R=R.toJSON(S)}if(typeof G==="function"){R=G.call(M,S,R)}switch(typeof R){case"string":return J(R);case"number":return isFinite(R)?String(R):"null";case"boolean":case"null":return String(R);case"object":if(!R){return"null"}D+=H;P=[];if(Object.prototype.toString.apply(R)==="[object Array]"){U=R.length;for(O=0;O<U;O+=1){P[O]=K(O,R)||"null"}Q=P.length===0?"[]":D?"[\n"+D+P.join(",\n"+D)+"\n"+N+"]":"["+P.join(",")+"]";D=N;return Q}if(G&&typeof G==="object"){U=G.length;for(O=0;O<U;O+=1){T=G[O];if(typeof T==="string"){Q=K(T,R);if(Q){P.push(J(T)+(D?": ":":")+Q)}}}}else{for(T in R){if(Object.hasOwnProperty.call(R,T)){Q=K(T,R);if(Q){P.push(J(T)+(D?": ":":")+Q)}}}}Q=P.length===0?"{}":D?"{\n"+D+P.join(",\n"+D)+"\n"+N+"}":"{"+P.join(",")+"}";D=N;return Q}}return function(N,M,O){var P;D="";H="";if(typeof O==="number"){for(P=0;P<O;P+=1){H+=" "}}else{if(typeof O==="string"){H=O}}G=M;if(M&&typeof M!=="function"&&(typeof M!=="object"||typeof M.length!=="number")){throw new Error("JSON.stringify")}return K("",{"":N})}});STK.register("core.json.strToJson",function(A){});STK.register("core.util.language",function(A){return function(D,E){return D.replace(/#L\{((.*?)(?:[^\\]))\}/ig,function(){var G=arguments[1];var F;if(E&&E[G]!==undefined){F=E[G]}else{F=G}return F})}});STK.register("core.util.listener",function(A){return(function(){var F={};var G;var I=[];var E;function D(){if(I.length==0){return}clearTimeout(E);var J=I.splice(0,1)[0];try{J.func.apply(J.func,[].concat(J.data))}catch(K){A.log("[error][listener]: One of "+J+"-"+J+" function execute error.")}E=setTimeout(D,25)}var H={conn:function(){var J=window;while(J!=top){J=J.parent;if(J.STK&&J.STK["core"]&&J.STK["core"]["util"]&&J.STK["core"]["util"]["listener"]!=null){G=J}}},register:function(J,K,L){if(G!=null){G.STK["core"]["util"]["listener"].register(J,K,L)}else{F[J]=F[J]||{};F[J][K]=F[J][K]||[];F[J][K].push(L)}},fire:function(N,L,M){if(G!=null){G.listener.fire(N,L,M)}else{var K;var O,J;if(F[N]&&F[N][L]&&F[N][L].length>0){K=F[N][L];K.data_cache=M;for(O=0,J=K.length;O<J;O++){I.push({channel:N,evt:L,func:K[O],data:M})}D()}}},remove:function(M,L,K){if(G!=null){G.STK["core"]["util"]["listener"].remove(M,L,K)}else{if(F[M]){if(F[M][L]){for(var N=0,J=F[M][L].length;N<J;N++){if(F[M][L][N]===K){F[M][L].splice(N,1);break}}}}}},list:function(){return F},cache:function(J,K){if(G!=null){return G.listener.cache(J,K)}else{if(F[J]&&F[J][K]){return F[J][K].data_cache}}}};return H})()});STK.register("core.util.easyTemplate",function(A){var D=function(F,E){if(!F){return""}if(F!==D.template){D.template=F;D.aStatement=D.parsing(D.separate(F))}var G=D.aStatement;var H=function(I){if(I){E=I}return arguments.callee};H.toString=function(){return(new Function(G[0],G[1]))(E)};return H};D.separate=function(G){var F=/\\'/g;var E=G.replace(/(<(\/?)#(.*?(?:\(.*?\))*)>)|(')|([\r\n\t])|(\$\{([^\}]*?)\})/g,function(O,L,I,H,K,J,N,M){if(L){return"{|}"+(I?"-":"+")+H+"{|}"}if(K){return"\\'"}if(J){return""}if(N){return"'+("+M.replace(F,"'")+")+'"}});return E};D.parsing=function(I){var H,E,G,N,M,L,F,J=["var aRet = [];"];F=I.split(/\{\|\}/);var K=/\s/;while(F.length){G=F.shift();if(!G){continue}M=G.charAt(0);if(M!=="+"&&M!=="-"){G="'"+G+"'";J.push("aRet.push("+G+");");continue}N=G.split(K);switch(N[0]){case"+et":H=N[1];E=N[2];J.push('aRet.push("<!--'+H+' start-->");');break;case"-et":J.push('aRet.push("<!--'+H+' end-->");');break;case"+if":N.splice(0,1);J.push("if"+N.join(" ")+"{");break;case"+elseif":N.splice(0,1);J.push("}else if"+N.join(" ")+"{");break;case"-if":J.push("}");break;case"+else":J.push("}else{");break;case"+list":J.push("if("+N[1]+".constructor === Array){with({i:0,l:"+N[1]+".length,"+N[3]+"_index:0,"+N[3]+":null}){for(i=l;i--;){"+N[3]+"_index=(l-i-1);"+N[3]+"="+N[1]+"["+N[3]+"_index];");break;case"-list":J.push("}}}");break;default:break}}J.push('return aRet.join("");');return[E,J.join("")]};return D});STK.register("core.util.pageletM",function(K){var U="http://www.douguo.com";var G="http://www.douguo.com";if(typeof $CONFIG!="undefined"){U=$CONFIG.jsPath||U;G=$CONFIG.cssPath||G}var P=K.core.arr.indexOf;var Q={},S,V={},T={},N={},R={};var E,F;if(K.IE){E={};F=function(){var A,D,W;for(A in E){if(E[A].length<31){W=K.E(A);break}}if(!W){A="style_"+K.core.util.getUniqueKey(),W=document.createElement("style");W.setAttribute("type","text/css");W.setAttribute("id",A);document.getElementsByTagName("head")[0].appendChild(W);E[A]=[]}return{styleID:A,styleSheet:W.styleSheet||W.sheet}}}var H=function(D,A){var W=U+D;if(!x(W,A)){return}K.core.io.scriptLoader({url:W,onComplete:function(){C(W)},onTimeout:function(){K.log(W+"timeout!");delete Q[W]}})};var O=function(A,D){if(!V[A]){V[A]=D}};var L=function(W){if(W){if(V[W]){try{T[W]||(T[W]=V[W](K))}catch(D){K.log(W,D)}}else{K.log("start:ns="+W+" ,have not been registed")}return}var A=[];for(W in V){A.push(W)}K.core.func.timedChunk(A,{process:function(X){try{T[X]||(T[X]=V[X](K))}catch(Y){K.log(X,Y)}}})};var J=function(f){var c=1,b,Z,A,W,e,Y,D;f=f||{};Z=f.pid;A=f.html;e=f.js?[].concat(f.js):[];W=f.css?[].concat(f.css):[];if(Z==undefined){K.log("node pid["+Z+"] is undefined");return}d(Z,e,W);Y=function(){if(--c>0){return}B(Z,function(h){(A!=undefined)&&(h.innerHTML=A);if(e.length>0){D()}a()})};D=function(h){if(e.length>0){H(e.shift(),D)}if(h&&h.indexOf("/pl/")!=-1){var i=h.replace(/^.*?\/(pl\/.*)\.js\??.*$/,"$1").replace(/\//g,".");I(i);L(i)}};if(W.length>0){c+=W.length;for(var g=0,X;(X=W[g]);g++){u({url:X,load_ID:"js_"+X.replace(/^\/?(.*)\.css\??.*$/i,"$1").replace(/\//g,"_"),complete:Y,pid:Z})}}Y()};var I=function(D){if(D){if(T[D]){K.log("destroy:"+D);try{T[D].destroy()}catch(A){K.log(A)}delete T[D]}return}for(D in T){K.log("destroy:"+D);try{T[D]&&T[D].destroy&&T[D].destroy()}catch(A){K.log(D,A)}}T={}};var M={register:O,start:L,view:J,clear:I,destroy:function(){M.clear();Q={};T={};V={};S=undefined}};K.core.dom.ready(function(){K.core.evt.addEvent(window,"unload",function(){K.core.evt.removeEvent(window,"unload",arguments.callee);M.destroy()})});return M});(function(){var A=STK.core;var D={tween:A.ani.tween,tweenArche:A.ani.tweenArche,arrCopy:A.arr.copy,arrClear:A.arr.clear,hasby:A.arr.hasby,unique:A.arr.unique,foreach:A.arr.foreach,isArray:A.arr.isArray,inArray:A.arr.inArray,arrIndexOf:A.arr.indexOf,findout:A.arr.findout,domNext:A.dom.next,domPrev:A.dom.prev,isNode:A.dom.isNode,addHTML:A.dom.addHTML,insertHTML:A.dom.insertHTML,setXY:A.dom.setXY,contains:A.dom.contains,position:A.dom.position,trimNode:A.dom.trimNode,insertAfter:A.dom.insertAfter,insertBefore:A.dom.insertBefore,removeNode:A.dom.removeNode,replaceNode:A.dom.replaceNode,Ready:A.dom.ready,setStyle:A.dom.setStyle,setStyles:A.dom.setStyles,getStyle:A.dom.getStyle,addClassName:A.dom.addClassName,hasClassName:A.dom.hasClassName,removeClassName:A.dom.removeClassName,builder:A.dom.builder,cascadeNode:A.dom.cascadeNode,selector:A.dom.selector,sizzle:A.dom.sizzle,addEvent:A.evt.addEvent,custEvent:A.evt.custEvent,removeEvent:A.evt.removeEvent,fireEvent:A.evt.fireEvent,fixEvent:A.evt.fixEvent,getEvent:A.evt.getEvent,stopEvent:A.evt.stopEvent,delegatedEvent:A.evt.delegatedEvent,preventDefault:A.evt.preventDefault,hotKey:A.evt.hotKey,memorize:A.func.memorize,bind:A.func.bind,getType:A.func.getType,methodBefore:A.func.methodBefore,timedChunk:A.func.timedChunk,funcEmpty:A.func.empty,ajax:A.io.ajax,jsonp:A.io.jsonp,ijax:A.io.ijax,scriptLoader:A.io.scriptLoader,require:A.io.require,jsonInclude:A.json.include,jsonCompare:A.json.compare,jsonClone:A.json.clone,jsonToQuery:A.json.jsonToQuery,queryToJson:A.json.queryToJson,jsonToStr:A.json.jsonToStr,strToJson:A.json.strToJson,objIsEmpty:A.obj.isEmpty,beget:A.obj.beget,cascade:A.obj.cascade,objSup:A.obj.sup,parseParam:A.obj.parseParam,bLength:A.str.bLength,dbcToSbc:A.str.dbcToSbc,leftB:A.str.leftB,trim:A.str.trim,encodeHTML:A.str.encodeHTML,decodeHTML:A.str.decodeHTML,parseURL:A.str.parseURL,parseHTML:A.str.parseHTML,queryString:A.str.queryString,htmlToJson:A.util.htmlToJson,cookie:A.util.cookie,drag:A.util.drag,timer:A.util.timer,jobsM:A.util.jobsM,listener:A.util.listener,winSize:A.util.winSize,pageSize:A.util.pageSize,templet:A.util.templet,queue:A.util.queue,stack:A.util.stack,swf:A.util.swf,URL:A.util.URL,scrollPos:A.util.scrollPos,scrollTo:A.util.scrollTo,getUniqueKey:A.util.getUniqueKey,storage:A.util.storage,pageletM:A.util.pageletM};for(var E in D){STK.regShort(E,D[E])}})();STK.register("kit.extra.language",function(A){window.$LANG||(window.$LANG={});return function(E,F){var D=A.core.util.language(E,$LANG);D=D.replace(/\\}/ig,"}");F&&(D=A.templet(D,F));return D}});STK.register("kit.dom.cssText",function(D){var A=function(H,F){var G=(H+";"+F).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),E;while(G&&(E=G.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i))){G=G.replace(E[1]+E[2]+E[3],"")}return G};return function(G){G=G||"";var F=[],E={push:function(I,H){F.push(I+":"+H);return E},remove:function(I){for(var H=0;H<F.length;H++){F[H].indexOf(I+":")==0&&F.splice(H,1)}return E},getStyleList:function(){return F.slice()},getCss:function(){return A(G,F.join(";"))}};return E}});STK.register("common.login.login",function(AV){typeof scope=="undefined"&&(scope={});var AT=AV.kit.extra.language,AU,AY,Aa,AW=AT(""),AX,AN,AO="#666666",AL="#999999",AM,AR,AS=0,AP=0,AQ,AF,AG=function(){},AD=AG,AE=AG,AJ=["sina.com","163.com","qq.com","126.com","vip.sina.com","sina.cn","hotmail.com","gmail.com","sohu.com"],AK,AH;typeof scope!="undefined"&&typeof scope.regUrl!="undefined"?AH=scope.regUrl:typeof $CONFIG!="undefined"&&typeof $CONFIG.regUrl!="undefined"?AH=$CONFIG.regUrl:AH="http://"+(document.domain=="www.weibo.com"?"www.weibo.com":"weibo.com")+"/signup/signup.php?c=&type=&inviteCode=&code=&spe=&lang=zh_cn";var AI=AT('<div class="WB_dialog" node-type="outer" style="z-index:99999;"><div class="WB_panel"><a title="#L{关闭}" node-type="close" class="WB_dl_close" href="#" onclick="return false;">#L{关闭}</a><div class="WB_login" node-type="inner"><div class="login_inner clearfix"><div class="login_main"><h3 class="login_tit">#L{已有新浪博客、新浪邮箱账号，可直接登录}</h3><p class="login_input_id"><input type="text" node-type="username" tabindex="1" style="color:#ccc" value="#L{邮箱/会员账号/手机账号}" class="WB_iptxt"></p><p class="login_input_pw"><input node-type="passwordtext" tabindex="2" style="color:#ccc" value="#L{请输入密码}" class="WB_iptxt"><input node-type="password" tabindex="3" type="password" style="color:#ccc" value="" class="WB_iptxt"></p><p class="login_input_vc" node-type="yzmDiv" style="display:none;"><input type="text" node-type="yzm" value="" class="WB_iptxt"><img src="about:blank" node-type="yzmUrl"><a class="change_vc" node-type="changePin" href="###">#L{换一换}</a></p><p class="login_input_wd" node-type="vdunDiv" style="display:none;"><input type="text" node-type="vdun" value="" class="WB_iptxt" /></p><p class="login_btn clearfix"><a class="WB_btnA" href="###" onclick="return false;" tabindex="5" node-type="submitBtn" ><span>#L{登录}</span></a><label class="rmb_log"><input node-type="saveState" tabindex="4" type="checkbox" class="WB_checkbox">#L{下次自动登录}</label></p></div><div class="reg_weibo"><h3 class="login_tit">#L{还未开通？赶快免费注册一个吧}</h3><p class="reg_wbid"><a class="WB_reg_btn" href="'+AH+'" tabindex="6" node-type="registUrl" target="_blank"><span>#L{注册微博}</span></a></p></div></div></div></div></div>'),AC='<div class="WB_tips_mini WB_t_err" style="z-index:100002;display:none;"><em class="W_error"></em><span class="tm_arr"></span></div>',AB=AV.common.login.loginAction,Aw,Au,Av="js_appstyle_open_css_module_layer_layer_login",Az,AA,Ax=document.getElementsByTagName("script");for(var Ay=0,Ao=Ax.length;Ay<Ao;Ay++){if(Ax[Ay].src&&/^http:\/\/js\.t\.sinajs\.cn/.test(Ax[Ay].src)){var Ap=Ax[Ay].src.split("version=");if(Ap.length>0){AA=Ap[1];break}}}AA==null&&(AA=(new Date).getTime());var Am,An={};An.showLoginLayer=function(A){};var As=function(){if(!Aw){Ad();Ak();Ac()}Af()},At,Aq=function(){},Ar=function(){},Ag=function(A){},Ah=function(){},Ae=function(){},Af=function(){},Ak=function(){},Al={},Ai=function(){},Aj=function(){},Ac=function(){},Ad=function(){},Ab=function(){};An.resetLoginLayer=Aj;An.destroy=Ab;An.close=Al.closeDialog;return An});typeof scope=="undefined"&&(scope={});scope.loginKit=function(){var G=document.cookie+";",E=["SUP","=([^;]*)?;"].join(""),F=["(\\?|&)","uid","=([^&]*)(&|$)"].join(""),A=G.match(new RegExp(E,"i"));A=A?A[1]||"":"";A=unescape(A);var D=A.match(new RegExp(F));D=D?D[2]||"":"";var H=scope.$oid;return{uid:D,isLogin:!!D,isAdmin:D&&H&&D==H}};scope.$isLogin=function(){return scope.loginKit().isLogin};scope.$isAdmin=function(){return scope.loginKit().isAdmin};STK.register("common.listener",function(E){var A={},D={};D.define=function(H,F){if(A[H]!=null){throw"common.listener.define: "}A[H]=F;var G={};G.register=function(I,J){if(A[H]==null){throw"common.listener.define: "}E.listener.register(H,I,J)};G.fire=function(I,J){if(A[H]==null){throw"commonlistener.define: "}E.listener.fire(H,I,J)};G.remove=function(J,I){E.listener.remove(H,J,I)};G.cache=function(I){return E.listener.cache(H,I)};return G};return D});STK.register("kit.dom.isTurnoff",function(A){return function(D){return !D.parentNode||D.parentNode.nodeType==11||!!D.disabled}});STK.register("kit.extra.textareaUtils",function(E){var A={},D=document.selection;A.selectionStart=function(K){if(!D){try{return K.selectionStart}catch(J){return 0}}var G=D.createRange(),H,L,F=0,I=document.body.createTextRange();I.moveToElementText(K);for(F;I.compareEndPoints("StartToStart",G)<0;F++){I.moveStart("character",1)}return F};A.selectionBefore=function(F){return F.value.slice(0,A.selectionStart(F))};A.selectText=function(I,H,F){I.focus();if(!D){I.setSelectionRange(H,F)}else{var G=I.createTextRange();G.collapse(1);G.moveStart("character",H);G.moveEnd("character",F-H);G.select()}};A.insertText=function(J,M,F,K){J.focus();K=K||0;if(!D){var L=J.value,H=F-K,I=H+M.length;J.value=L.slice(0,H)+M+L.slice(F,L.length);A.selectText(J,I,I)}else{var G=D.createRange();G.moveStart("character",-K);G.text=M}};A.replaceText=function(J,M){J.focus();var F=J.value,K=A.getSelectedText(J),L=K.length;if(K.length==0){A.insertText(J,M,A.getCursorPos(J))}else{var H=A.getCursorPos(J);if(!D){var G=H+K.length;J.value=F.slice(0,H)+M+F.slice(H+L,F.length);A.setCursor(J,H+M.length);return}var I=D.createRange();I.text=M;A.setCursor(J,H+M.length)}};A.getCursorPos=function(I){var H=0;if(STK.core.util.browser.IE){I.focus();var F=null;F=D.createRange();var G=F.duplicate();G.moveToElementText(I);G.setEndPoint("EndToEnd",F);I.selectionStart=G.text.length-F.text.length;I.selectionEnd=I.selectionStart+F.text.length;H=I.selectionStart}else{if(I.selectionStart||I.selectionStart=="0"){H=I.selectionStart}}return H};A.getSelectedText=function(H){var G="",F=function(I){return I.selectionStart!=undefined&&I.selectionEnd!=undefined?I.value.substring(I.selectionStart,I.selectionEnd):""};window.getSelection?G=F(H):G=D.createRange().text;return G};A.setCursor=function(I,G,H){G=G==null?I.value.length:G;H=H==null?0:H;I.focus();if(I.createTextRange){var F=I.createTextRange();F.move("character",G);F.moveEnd("character",H);F.select()}else{I.setSelectionRange(G,G+H)}};A.unCoverInsertText=function(J,H,I){I=I==null?{}:I;I.rcs=I.rcs==null?J.value.length:I.rcs*1;I.rccl=I.rccl==null?0:I.rccl*1;var F=J.value,G=F.slice(0,I.rcs),K=F.slice(I.rcs+I.rccl,F==""?0:F.length);J.value=G+H+K;this.setCursor(J,I.rcs+(H==null?0:H.length))};return A});STK.register("module.at",function(N){var L=window,M=document,Q=N.core.util.browser,A="font-family:Tahoma,宋体;",O=N.kit.extra.textareaUtils.selectionStart,P,F,G,D,E,J=function(){var R={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',A,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',A,'"> </span>'].join("")};return function(S){var T=S.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(U){return R[U]});return T}}(),K=function(){var S=[],T=P.textEl.style.cssText,R;N.foreach(["margin","padding","border"],function(U){N.foreach(["Top","Left","Bottom","Right"],function(V){var W;U!="border"?W=S.push(U,"-",V.toLowerCase(),":",N.getStyle(P.textEl,U+V),";"):N.foreach(["Color","Style","Width"],function(X){S.push(U,"-",V.toLowerCase(),"-",X.toLowerCase(),":",N.getStyle(P.textEl,[U,V,X].join("")),";")})})});S.push("font-size:"+N.getStyle(P.textEl,"fontSize")+";");return N.kit.dom.cssText([T,S.join(""),A,"word-wrap: break-word;line-height: 18px;overflow-y:auto;overflow-x:hidden;outline:none;"].join("")).getCss()},H=function(){var Z=N.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list,R=Z.wrap[0],c=Z.flag[0],V=Z.after[0],W=Z.before[0],U=0,X,Y,S,T=function(b){return Q.MOZ?-2:Q.MOBILE&&Q.SAFARI&&(Q.IPAD||Q.ITOUCH||Q.IPHONE)?-2:0};return{bind:function(){if(Y!==P.textEl){E=N.position(P.textEl);var f=["left:",E.l,"px;top:",E.t+20,"px;"].join("");Y=P.textEl;var e=K();Y.style.cssText=e;S=[f,e,"position:absolute;filter:alpha(opacity=0);opacity:0;z-index:-1000;"].join("");R.style.cssText=S;if(!U){U=1;M.body.appendChild(R)}}},content:function(f,g,e,h){R.style.cssText=[S,"width:",(Y.offsetWidth||parseInt(N.getStyle(Y,"width")))+T(),"px;height:",Y.offsetHeight||parseInt(N.getStyle(Y,"height")),"px;overflow-x:hidden;overflow-y:",/webkit/i.test(navigator.userAgent)?"hidden":N.getStyle(Y,"overflowY"),";"].join("");W.innerHTML=J(f);c.innerHTML=J(g)||"&thinsp;";V.innerHTML=J([e,h].join(""));clearTimeout(X);X=setTimeout(function(){var i=N.position(c);N.custEvent.fire(P.eId,"at",{t:i.t-Y.scrollTop-E.t+5,l:i.l-E.l+5,key:e,flag:g,textarea:P.textEl})},30)},hide:function(){R.style.display="none"},show:function(){R.style.display=""}}}(),I=function(){if(N.kit.dom.isTurnoff(P.textEl)){clearInterval(F)}else{var U=P.textEl.value.replace(/\r/g,""),V=O(P.textEl);if(V<0||V==D){return}D=V;var R=U.slice(0,V),S=R.match(new RegExp(["(",P.flag,")([a-zA-Z0-9一-龥_]{0,20})$"].join("")));if(!S){N.custEvent.fire(P.eId,"hidden");return}var T=U.slice(V);R=R.slice(0,-S[0].length);H.content(R,S[1],S[2],T)}};return function(S){if(!!S&&!!S.textEl){S=N.parseParam({textEl:null,flag:"@",eId:N.custEvent.define({},["at","hidden"])},S);var T=function(){if(!!P){clearInterval(F);N.removeEvent(P.textEl,"blur",T);H.hide()}},R=function(){T();P=S;D=null;H.bind();H.show();F=setInterval(I,200);N.addEvent(S.textEl,"blur",T)};N.addEvent(S.textEl,"focus",R);return S.eId}}});STK.register("kit.io.ajax",function(A){return function(I){var J,M,D,K,L,G,H;G=function(N){L=!1;I.onComplete(N,J.args);setTimeout(E,0)};H=function(N){L=!1;I.onFail(N,J.args);setTimeout(E,0)};D=[];K=null;L=!1;J=A.parseParam({url:"",method:"get",responseType:"json",timeout:30000,onTraning:A.funcEmpty,isEncode:!0},I);J.onComplete=G;J.onFail=H;var E=function(){if(!!D.length){if(L===!0){return}L=!0;J.args=D.shift();K=A.ajax(J)}},F=function(O){while(D.length){D.shift()}L=!1;if(K){try{K.abort()}catch(N){}}K=null};M={};M.request=function(N){N||(N={});I.noQueue&&F();if(!I.uniqueRequest||!K){D.push(N);N._t=0;E()}};M.abort=F;return M}});STK.register("module.suggest",function(M){var K=null,L=M.custEvent,P=L.define,A=L.fire,N=L.add,O=M.addEvent,F=M.removeEvent,G=M.stopEvent,D=[],E={},I={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9},J=function(f){var g=-1,W=[],X=f.textNode,e=f.uiNode,Y=M.core.evt.delegatedEvent(e),Z=P(X,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);Z.setFlag=S;var S=function(b){f.flag=b},T=function(){return M.sizzle(["[action-type=",f.actionType,"]"].join(""),e)},Q=function(){g=-1;F(X,"keydown",R);Y.destroy()},R=function(h){var c,i;if(!!(c=h)&&!!(i=c.keyCode)){if(i==I.ENTER){G();A(Z,"onSelect",[g,X,f.flag]);return !1}if(i==I.UP){G();var b=T().length;g=g<1?b-1:g-1;A(Z,"onIndexChange",[g]);return !1}if(i==I.DOWN){G();var b=T().length;g=g==b-1?0:g+1;A(Z,"onIndexChange",[g]);return !1}if(i==I.ESC){G();Q();A(Z,"onClose");return !1}if(i==I.TAB){Q();A(Z,"onClose");return !1}}},U=function(b){A(Z,"onSelect",[M.core.arr.indexOf(b.el,T()),X,f.flag])},V=function(c){g=M.core.arr.indexOf(c.el,T());A(Z,"onIndexChange",[M.core.arr.indexOf(c.el,T())])};N(Z,"open",function(h,b){X=b;Q();O(b,"keydown",R);Y.add(f.actionType,"mouseover",V);Y.add(f.actionType,"click",U);A(Z,"onOpen",[f.flag])});N(Z,"openSetFlag",function(h,c){S(c)});N(Z,"close",function(){Q();A(Z,"onClose",[f.flag])});N(Z,"indexChange",function(c,b){g=b;A(Z,"onIndexChange",[g,f.flag])});return Z},H=function(R){var S=R.textNode,Q=M.core.arr.indexOf(S,D);if(!E[Q]){D[Q=D.length]=S;E[Q]=J(R)}return E[Q]};return function(Q){if(!!Q.textNode&&!!Q.uiNode){Q=M.parseParam({textNode:K,uiNode:K,actionType:"item",actionData:"index",flag:""},Q);return H(Q)}}});STK.register("common.channel.at",function(D){var A=["open","close"];return D.common.listener.define("common.channel.at",A)});STK.register("kit.dom.firstChild",function(D){var A=D.core.dom.next;return function(F){var E=F.firstChild;E&&E.nodeType!=1&&(E=A(E));return E}});STK.register("kit.dom.layoutPos",function(A){return function(I,J,M){if(!A.isNode(J)){throw"kit.dom.layerOutElement need element as first parameter"}if(J===document.body){return !1}if(!J.parentNode){return !1}if(J.style.display==="none"){return !1}var D,K,L,G,H,E,F;D=A.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},M);K=J;if(!K){return !1}while(K!==document.body){K=K.parentNode;if(K.style.display==="none"){return !1}E=A.getStyle(K,"position");F=K.getAttribute("layout-shell");if(E==="absolute"||E==="fixed"){break}if(F==="true"&&E==="relative"){break}}K.appendChild(I);L=A.position(J,{parent:K});G={w:J.offsetWidth,h:J.offsetHeight};H=D.pos.split("-");H[0]==="left"?I.style.left=L.l+D.offsetX+"px":H[0]==="right"?I.style.left=L.l+G.w+D.offsetX+"px":H[0]==="center"&&(I.style.left=L.l+G.w/2+D.offsetX+"px");H[1]==="top"?I.style.top=L.t+D.offsetY+"px":H[1]==="bottom"?I.style.top=L.t+G.h+D.offsetY+"px":H[1]==="middle"&&(I.style.top=L.t+G.h/2+D.offsetY+"px");return !0}});STK.register("common.editor.plugin.at",function(U){var S=U.kit.extra.language,T='<div class="WB_tips_smart WB_email"><p class="tipsmt_title" node-type="suggestTitle">想用@提到谁</p><ul class="tipsmt_list" node-type="suggestWrap"></ul></div>',X={"@":{normalTitle:S("#L{选择昵称或轻敲空格完成输入}"),moreTitle:S("#L{选择最近@的人或直接输入}"),noTilte:S("#L{轻敲空格完成输入}")},"#":{normal:S("#L{ }")}},Y={"@":'<#et temp data><#list data.data as list><li action-type="item" <#if (list_index == 0)>class="tipsmt_cur" </#if>action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}<#if (list.remark)>(${list.remark})</#if></a></li><#if (list.count)><span>${list.count}</span></#if></#list></#et>',"#":'<#et temp data><#list data.data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.topic}" value="${list.topic}"><a href="#">${list.topic}<#if (list.count)>(${list.count})</#if></a></li></#list></#et>'},V,W,M,N,K,L,Q,R=!1,O,P,E={"@":"at","#":"topicList"},F=0,A=function(){setTimeout(function(){U.custEvent.fire(V,"close")},200)},D=function(){L.style.display="none"},I=function(){U.custEvent.add(V,"onIndexChange",function(e,c){z(c)});U.custEvent.add(V,"onSelect",function(Ac,Ad,Af,f){F=0;U.core.evt.stopEvent();var Ae=P[Ad].getAttribute("value");Ae=Ae.replace(/\(.*\)/,"");try{Af.focus()}catch(v){}var w=U.kit.extra.textareaUtils.selectionStart(Af)*1,s=new RegExp(f+"([a-zA-Z0-9一-龥_]{0,20})$"),t=Af.value.replace(/\r+/g,"").slice(0,w).match(s),Aa=Af.value.slice(w,w+1);t=t&&t[1]?t[1].length:0;var Ab=U.kit.extra.textareaUtils;f=="#"?typeof Aa!="undefined"&&Aa!=f&&(Ae=Ae+f+" "):Ae=Ae+" ";Ab.insertText(Af,Ae,w,t);var y=Ab.getCursorPos(Af);if(f=="#"&&Aa==f){Ab.setCursor(Af,y+1);Ab.insertText(Af," ",y+1,0)}y=Ab.getCursorPos(Af);var o=Ab.getSelectedText(Af),q=o==""||o==null?0:o.length;Af.setAttribute("range",y+"&"+q);U.custEvent.fire(V,"close")});U.addEvent(M.textEl,"blur",A);U.custEvent.add(V,"onClose",D);U.custEvent.add(V,"onOpen",function(e,f){K.style.display="";L.style.display="";R=!0;setTimeout(function(){U.custEvent.fire(V,"indexChange",0)},100)})},J=function(h,i,j){h=="@"?i.data&&i.data.length>0?i.title=j==""?X[h].moreTitle:X[h].normalTitle:i.title=X[h].noTilte:i.title=X[h].normalTitle;var e=U.core.util.easyTemplate(Y[h],i);return e},G=function(){U.core.evt.custEvent.add(W,"hidden",function(e,f){U.custEvent.fire(V,"close")});U.core.evt.custEvent.add(W,"at",function(i,j){Q=j.key;var h=j.flag;if(Q.length==0&&h!="@"){U.custEvent.fire(V,"close")}else{var f=document.location.host=="widget.douguo.com"?"":"/widget";U.core.io.ajax({method:"post",url:"/uajax/getDgAtInfo",args:{appkey:$("#atappsrc").val(),q:Q},onComplete:function(o){if(o.code=="100000"){var c=J(h,o,Q);U.custEvent.fire(V,"openSetFlag",h);U.custEvent.fire(V,"open",j.textarea);var e=U.core.dom.builder(c),n=e.box;K.innerHTML=n;K.style.display=o.data.length==0?"none":"";if(Q.length==0){N.innerHTML=X["@"].moreTitle}else{if(o.data.length==0){N.innerHTML=X["@"].noTilte}else{N.innerHTML=X["@"].normalTitle}}L.style.cssText=["z-index:11001;background-color:#ffffff;position:absolute;"].join("");U.common.channel.at.fire("open");U.kit.dom.layoutPos(L,j.textarea,{pos:"left-top",offsetX:j.l,offsetY:j.t})}else{U.custEvent.fire(V,"close")}},onFail:function(){U.custEvent.fire(V,"close")}})}})},H=function(){O=M.textEl;W=STK.module.at({textEl:O,flag:"@"})},Z=function(e){F=0;L&&(L.style.display="none");L&&(L.innerHTML="");var c=U.builder(T);L=U.kit.dom.firstChild(c.box);L.style.display="none";document.body.appendChild(L);N=c.list.suggestTitle[0];K=c.list.suggestWrap[0];V&&U.custEvent.fire(V,"close");V&&U.custEvent.remove(V);V=U.module.suggest({textNode:e,uiNode:K,actionType:"item",actionData:"value",flag:"@"});I()},z=function(c){P=U.sizzle("li",K);P&&P[0]&&U.core.dom.removeClassName(P[F],"tipsmt_cur");U.core.dom.addClassName(P[c],"tipsmt_cur");F=c};return function(g,e){M=g.nodeList;var f={};f.init=function(){H();Z(M.textEl);G()};return f}});STK.register("common.editor.simpleEditor",function(G){var E=G.core.str.trim,F,A=G.common.editor.getLength,D=function(K,I){var J=1,H=Math.abs(I-J),L;J>I||J<1?L={wordsnum:J,vnum:H,overflow:!0}:J==0?L={wordsnum:J,vnum:H,overflow:!0}:L={wordsnum:J,vnum:H,overflow:!1};return L};return function(O,M){M=M||{};var N=M.limit||140;if(!O){throw"[easyEditor]: editor is null"}G.custEvent.define(O,"textNum");G.custEvent.define(O,"keyUpCount");var J=G.sizzle('[node-type="editor"]',O)[0],K=G.sizzle('[node-type="wordNum"]',O)[0];if(M.atSwitch!=null&&M.atSwitch==!0){var H=G.common.editor.plugin.at({nodeList:{textEl:J}},M);H.init()}var L=$("#"+STK.wbid).find(":input");L.live("focus",function(){F=setInterval(function(){I()},200)});L.live("blur",function(){F&&clearInterval(F)});var I=function(){var P=E(J.value).length==0?E(J.value):J.value;P=P.replace(/\r\n/g,"\n");var Q=D(P,N);G.custEvent.fire(O,"textNum",{count:Q.wordsnum,isOver:Q.overflow})};G.addEvent(J,"keyup",I);G.custEvent.add(O,"keyUpCount",I);I()}});STK.register("comp.share.share",function(AH){function I(){}function K(F,D,E,A){}function J(){/\((iPhone|iPad|iPod)/i.test(navigator.userAgent)||function(A,D){}(window,document)}function Ac(){return scope.$isLogin()?!0:!1}function Ab(){AH.module.mask.hide();Ad("shareWait").style.display="none"}function Ae(A){}function Ad(A){return AH.E(A)}function N(A){return Aq.createElement(A)}function M(A){}function Aa(E,D,F,A){}function O(){var D=scope.loginKit().uid,A=scope.$refer?scope.$refer:"";(new Image).src="http://rs.sinajs.cn/d.gif?uid="+D+"&refer="+A+"&_rnd="+ +(new Date)}var AF=AH.core,AG=AF.evt.addEvent,AK=AF.evt.getEvent,G=AF.str.trim,AI=AF.evt.removeEvent,AJ=AF.dom.sizzle,Az=AF.io.ajax,AA=AF.evt.fireEvent,Ax=AF.evt.stopEvent,Ay=AF.dom.getSize,AD=AF.dom.setXY,AE=AH.kit.extra.language,AB=AH.common.login.login.close,AC=AH.common.editor.simpleEditor,Ar=AH.common.login.getUserInfo,As=AH.common.editor.getLength,Ap=AH.common.login.getLoginStatus,Aq=document,Av=0,Aw={gpID:0,gpName:"",pic:"",isFav:0,isMark:0},At=1,Au={},An=1,Ao=0,Am=/message=1&|message=1$/.test(document.URL)?"privateMsg":"weibo",Ai,Ag,Ah,Ak,Al,Aj,Af={},L={editorKeyUp:function(A){},addMark:function(A){},share:function(A){},logoutCb:function(A){Ao=1;An=1;Ad("shareIt").className="WB_btn_share_dis"}},H=function(D,A){};return function(P,D){var E={},A=function(){if(top!=self){top.location=self.location}else{scope.loginKit().uid&&Ar();J();Q();Ax();O()}},Q=function(){AG(Ad("share_tab"),"click",L.tab);Au.weibo=Ad("weiboPublisher");Au.privateMsg=Ad("privateMsgPublisher");if(STK.wbid==undefined){STK.wbid="weiboDiv"}AC(Ad(STK.wbid),{limit:140,atSwitch:!0});AC(Ad("privateMsgDiv"),{limit:300,atSwitch:!0});AH.E("shareIt").className="WB_btn_share";AG(Au.weibo,"keyup",L.editorKeyUp);AG(Au.privateMsg,"keyup",L.editorKeyUp);AA(Au.weibo,"keyup");if(scope.picLst&&scope.picLst.length>0){scope.picLst.length<=5&&Ad("pageDom")&&(Ad("pageDom").style.display="none");Aw.pic=scope.picLst[0];H(scope.picLst,5);AG(Ad("cancelPic"),"click",L.cancelPic);Aa(Ad("picContain"),"li","click",function(V){var T="plus_cur",U=this.getAttribute("data");if(U!=="disabled"){if(U==="hover"&&T===this.className){this.className="";Aw.pic="";return}if(T===V.className){return}var S=AJ("li."+T,Ad("picContain"))[0];S&&(S.className="");this.className=T;Aw.pic=this.getAttribute("rel");Av=this.getAttribute("picid")}})}var R=Ad("addMark");R.checked=!1;AG(R,"click",L.addMark);AG(Ad("shareIt"),"click",L.share);AH.core.evt.hotKey.add(Ad("weiboPublisher"),"ctrl+Enter",L.share);/message=1&|message=1$/.test(document.URL)&&L.privateMsg()},F=function(){};A();E.destroy=F;return E}});STK.pageletM.register("pl.share.share",function(G){try{var E={},F=G.E("pl_share"),A=G.comp.share.share(F,E);return A}catch(D){}});STK.pageletM.register("pl.share.login",function(F){var D={},E=F.E("pl_share_login"),A=F.comp.share.login(E,D);return A});STK.pageletM.start();